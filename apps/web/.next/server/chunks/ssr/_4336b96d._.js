module.exports=[5050,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={callServer:function(){return f.callServer},createServerReference:function(){return h.createServerReference},findSourceMapURL:function(){return g.findSourceMapURL}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(20611),g=a.r(1722),h=a.r(38783)},46940,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(73603),e=a.i(36847),f=a.i(80726),g=a.i(49666);function h(a){}function i(a,b){let c=[];if(c.length>=f.MAX_LABELS_GLOBAL||c.some(b=>b.name.toLowerCase()===a.toLowerCase()))return null;let d={id:(0,g.v4)(),name:a.trim(),color:b};return c.push(d),h(c),d}function j(a){return[].filter(b=>a.includes(b.id))}var k=a.i(3432);function l({selectedLabelIds:a,onChange:d,onLabelsCreated:e,buttonPosition:g="left"}){let[h,l]=(0,c.useState)(!1),[m,n]=(0,c.useState)([]),[o,p]=(0,c.useState)(!1),[q,r]=(0,c.useState)(""),[s,t]=(0,c.useState)("green"),[u,v]=(0,c.useState)(""),w=(0,c.useRef)(null);(0,c.useEffect)(()=>{n([])},[h]),(0,c.useEffect)(()=>{let a=a=>{w.current&&!w.current.contains(a.target)&&(l(!1),p(!1))};return document.addEventListener("mousedown",a),()=>document.removeEventListener("mousedown",a)},[]);let x=j(a),y=a.length<f.MAX_LABELS_PER_MEDICINE,z=b=>{a.includes(b)?d(a.filter(a=>a!==b)):y&&d([...a,b])},A=()=>{if(v(""),!q.trim())return void v("Nazwa jest wymagana");if(m.length>=f.MAX_LABELS_GLOBAL)return void v(`Limit ${f.MAX_LABELS_GLOBAL} etykiet`);let b=i(q.trim(),s);b?(n([]),r(""),t("green"),p(!1),e?.(),window.dispatchEvent(new CustomEvent("labelsUpdated")),y&&d([...a,b.id])):v("Etykieta juÅ¼ istnieje")},B=Object.entries(f.LABEL_COLORS);return(0,b.jsxs)("div",{className:`relative ${"right"===g?"flex flex-wrap items-start justify-between gap-2 pr-1":""}`,ref:w,children:["right"===g&&(0,b.jsx)("div",{className:"flex flex-wrap gap-1 p-1 flex-1 min-h-[28px]",children:x.map(a=>(0,b.jsxs)("span",{className:"inline-flex items-center gap-1 text-xs px-2 py-0.5 rounded-full",style:{backgroundColor:f.LABEL_COLORS[a.color].hex,color:"white",boxShadow:"2px 2px 4px rgba(0,0,0,0.15), -2px -2px 4px rgba(255,255,255,0.1)"},children:[a.name,(0,b.jsx)("button",{onClick:b=>{b.stopPropagation(),z(a.id)},className:"opacity-70 hover:opacity-100",children:"Ã—"})]},a.id))}),(0,b.jsxs)("div",{className:"right"===g?"flex-shrink-0":"",children:[(0,b.jsxs)("button",{onClick:a=>{a.stopPropagation(),l(!h)},className:"neu-tag text-xs flex items-center gap-1",style:{color:"var(--color-text)"},children:[(0,b.jsx)(k.SvgIcon,{name:"tags",size:14,style:{color:"var(--color-accent)"}})," Etykiety",x.length>0&&(0,b.jsx)("span",{className:"ml-1 px-1.5 py-0.5 rounded-full text-white text-xs",style:{backgroundColor:"var(--color-accent)"},children:x.length})]}),h&&(0,b.jsxs)("div",{className:`absolute ${"right"===g?"right-0":"left-0"} bottom-full mb-1 z-[200] neu-flat p-3 pr-4 min-w-[200px] animate-popIn`,onClick:a=>a.stopPropagation(),children:[!y&&(0,b.jsxs)("p",{className:"text-xs mb-2",style:{color:"var(--color-warning)"},children:["Max ",f.MAX_LABELS_PER_MEDICINE," etykiet na lek"]}),m.length>0?(0,b.jsx)("div",{className:"space-y-1.5 mb-2",children:m.map(c=>{let d=a.includes(c.id),e=!d&&!y;return(0,b.jsxs)("button",{onClick:()=>!e&&z(c.id),className:`w-full flex items-center gap-2 px-2 py-1.5 rounded-lg text-left text-xs transition-all ${d?"neu-tag active":"neu-tag"} ${e?"opacity-50 cursor-not-allowed":""}`,disabled:e,children:[(0,b.jsx)("span",{className:"w-3 h-3 rounded-full flex-shrink-0",style:{backgroundColor:f.LABEL_COLORS[c.color].hex}}),(0,b.jsx)("span",{className:d?"text-white":"",children:c.name}),d&&(0,b.jsx)("span",{className:"ml-auto",children:"âœ“"})]},c.id)})}):!o&&(0,b.jsx)("p",{className:"text-xs mb-2",style:{color:"var(--color-text-muted)"},children:"Brak etykiet"}),o?(0,b.jsxs)("div",{className:"space-y-2 pt-2",style:{borderTop:"1px solid var(--shadow-dark)"},children:[(0,b.jsx)("input",{type:"text",value:q,onChange:a=>r(a.target.value),placeholder:"Nazwa...",className:"neu-input text-xs w-full",style:{padding:"0.375rem"},maxLength:20,autoFocus:!0,onKeyDown:a=>"Enter"===a.key&&A()}),(0,b.jsx)("div",{className:"flex flex-wrap gap-1",children:B.map(([a,c])=>(0,b.jsx)("button",{onClick:()=>t(a),className:`w-5 h-5 rounded-full ${s===a?"ring-2 ring-offset-1":""}`,style:{backgroundColor:c.hex},title:c.name},a))}),u&&(0,b.jsx)("p",{className:"text-xs",style:{color:"var(--color-error)"},children:u}),(0,b.jsxs)("div",{className:"flex gap-1",children:[(0,b.jsx)("button",{onClick:A,className:"neu-tag text-xs",style:{color:"var(--color-success)"},children:"Zapisz"}),(0,b.jsx)("button",{onClick:()=>{p(!1),v("")},className:"neu-tag text-xs",children:"Anuluj"})]})]}):m.length<f.MAX_LABELS_GLOBAL&&(0,b.jsx)("button",{onClick:()=>p(!0),className:"w-full neu-tag text-xs mt-1",style:{color:"var(--color-accent)"},children:"+ Nowa etykieta"})]})]}),"left"===g&&x.length>0&&!h&&(0,b.jsx)("div",{className:"flex flex-wrap gap-1 mt-1.5",children:x.map(a=>(0,b.jsxs)("span",{className:"inline-flex items-center gap-1 text-xs px-2 py-0.5 rounded-full",style:{backgroundColor:f.LABEL_COLORS[a.color].hex,color:"white",boxShadow:"2px 2px 4px rgba(0,0,0,0.15), -2px -2px 4px rgba(255,255,255,0.1)"},children:[a.name,(0,b.jsx)("button",{onClick:b=>{b.stopPropagation(),z(a.id)},className:"opacity-70 hover:opacity-100",children:"Ã—"})]},a.id))})]})}var m=a.i(35112);function n({url:a,title:d,onClose:e}){let[f,g]=(0,c.useState)(!1),[h,i]=(0,c.useState)(!1),[j,k]=(0,c.useState)(!0),l=`/api/pdf-proxy?url=${encodeURIComponent(a)}`;if((0,c.useEffect)(()=>(g(!0),document.body.style.overflow="hidden",()=>{document.body.style.overflow=""}),[]),(0,c.useEffect)(()=>{let a=a=>{"Escape"===a.key&&e()};return window.addEventListener("keydown",a),()=>window.removeEventListener("keydown",a)},[e]),(0,c.useEffect)(()=>{(async()=>{try{(await fetch(l,{method:"HEAD"})).ok||i(!0)}catch{i(!0)}finally{k(!1)}})()},[l]),!f)return null;let n=(0,b.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-2 sm:p-4 animate-fadeIn",style:{backgroundColor:"rgba(0, 0, 0, 0.8)",zIndex:9999},onClick:e,children:(0,b.jsxs)("div",{className:"neu-flat w-full max-w-5xl h-[95vh] sm:h-[90vh] flex flex-col animate-popIn",style:{maxHeight:"calc(100vh - 1rem)"},onClick:a=>a.stopPropagation(),children:[(0,b.jsxs)("div",{className:"p-3 sm:p-4 border-b",style:{borderColor:"var(--shadow-dark)"},children:[(0,b.jsxs)("div",{className:"flex items-center justify-between gap-2 mb-2 sm:mb-0",children:[(0,b.jsxs)("h2",{className:"text-sm sm:text-lg font-semibold truncate flex-1",style:{color:"var(--color-text)"},children:["ðŸ“„ ",d]}),(0,b.jsx)("button",{onClick:e,className:"neu-tag text-lg px-3 py-1 flex-shrink-0",style:{color:"var(--color-error)"},title:"Zamknij (Esc)",children:"âœ•"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,b.jsx)("a",{href:a,target:"_blank",rel:"noopener noreferrer",className:"neu-tag text-xs",style:{color:"var(--color-accent)"},children:"ðŸ”— OtwÃ³rz w RPL"}),(0,b.jsx)("a",{href:l,download:`${d}.pdf`,className:"neu-tag text-xs",style:{color:"var(--color-accent)"},children:"ðŸ“¥ Pobierz PDF"})]})]}),(0,b.jsxs)("div",{className:"flex-1 p-2 min-h-0 flex items-center justify-center",children:[j&&(0,b.jsxs)("div",{className:"text-center",style:{color:"var(--color-text-muted)"},children:[(0,b.jsx)("div",{className:"text-2xl mb-2",children:"â³"}),(0,b.jsx)("p",{children:"Åadowanie ulotki..."})]}),!j&&h&&(0,b.jsxs)("div",{className:"text-center p-4",style:{color:"var(--color-text)"},children:[(0,b.jsx)("div",{className:"text-4xl mb-4",children:"ðŸ“„"}),(0,b.jsx)("p",{className:"mb-4",children:"Nie moÅ¼na wyÅ›wietliÄ‡ podglÄ…du ulotki."}),(0,b.jsx)("p",{className:"text-sm mb-4",style:{color:"var(--color-text-muted)"},children:"UÅ¼yj przyciskÃ³w powyÅ¼ej, aby otworzyÄ‡ lub pobraÄ‡ PDF."}),(0,b.jsx)("a",{href:a,target:"_blank",rel:"noopener noreferrer",className:"neu-button inline-block px-6 py-3",style:{color:"var(--color-accent)"},children:"ðŸ”— OtwÃ³rz w Rejestrze MZ"})]}),!j&&!h&&(0,b.jsx)("iframe",{src:l,className:"w-full h-full rounded-lg",style:{backgroundColor:"white",border:"none"},title:d,onError:()=>i(!0)})]})]})});return(0,m.createPortal)(n,document.body)}var o=a.i(5050);let p=(0,o.createServerReference)("409a5b36d98edf6e2d19becca7033c7bd03c5b2984",o.callServer,void 0,o.findSourceMapURL,"searchMedicineInRpl");function q(a){return a?new Date(a).toLocaleDateString("pl-PL"):"Nie ustawiono"}function r({medicine:a,onDelete:d,onUpdateExpiry:e,onUpdateLabels:g,onUpdateNote:h,onUpdateLeaflet:i,isCollapsed:m=!1,onToggleCollapse:o}){let[r,s]=(0,c.useState)(!1),[t,u]=(0,c.useState)(a.terminWaznosci||""),[v,w]=(0,c.useState)(!1),[x,y]=(0,c.useState)(a.notatka||""),[z,A]=(0,c.useState)(!1),[B,C]=(0,c.useState)([]),[D,E]=(0,c.useState)(!1),[F,G]=(0,c.useState)(!1),[H,I]=(0,c.useState)(""),J=function(a){if(!a)return"unknown";let b=new Date,c=Math.ceil((new Date(a).getTime()-b.getTime())/864e5);return c<0?"expired":c<=30?"expiring-soon":"valid"}(a.terminWaznosci),K=async a=>{let b=a||H;if(b&&!(b.trim().length<3)){E(!0);try{let a=await p(b.trim());C(a)}catch(a){console.error("BÅ‚Ä…d wyszukiwania ulotki:",a),C([])}finally{E(!1)}}};b.Fragment,k.SvgIcon,b.Fragment,k.SvgIcon,b.Fragment,k.SvgIcon,b.Fragment,k.SvgIcon;let L={expired:(0,b.jsx)(k.SvgIcon,{name:"alert-triangle",size:16,style:{color:"var(--color-error)"}}),"expiring-soon":(0,b.jsx)(k.SvgIcon,{name:"clock",size:16,style:{color:"var(--color-warning)"}}),valid:(0,b.jsx)(k.SvgIcon,{name:"check-circle",size:16,style:{color:"var(--color-success)"}}),unknown:(0,b.jsx)(k.SvgIcon,{name:"help-circle",size:16,style:{color:"var(--color-text-muted)"}})};return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("article",{className:`p-5 rounded-2xl transition-all duration-300 hover:-translate-y-1 glass-dark ${{expired:"neu-status-error","expiring-soon":"neu-status-warning",valid:"neu-status-valid",unknown:"neu-status-unknown"}[J]}`,style:{borderRadius:"20px",overflow:"visible"},children:[(0,b.jsxs)("header",{className:"mb-3 flex items-start justify-between cursor-pointer group",onClick:o,role:"button","aria-expanded":!m,children:[(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-x-3 gap-y-1 flex-1",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold",style:{color:"var(--color-text)"},children:a.nazwa||(0,b.jsx)("span",{className:"italic",style:{color:"var(--color-text-muted)"},children:"Nazwa nieznana"})}),m&&a.labels&&a.labels.length>0&&(0,b.jsx)("div",{className:"flex flex-wrap gap-1 pl-1",children:j(a.labels).map(a=>(0,b.jsx)("span",{className:"inline-flex items-center text-xs px-1.5 py-0.5 rounded-full",style:{backgroundColor:f.LABEL_COLORS[a.color].hex,color:"white",fontSize:"0.65rem",boxShadow:"1px 1px 2px rgba(0,0,0,0.15), -1px -1px 2px rgba(255,255,255,0.1)"},children:a.name},a.id))})]}),(0,b.jsx)("span",{className:`neu-tag p-2 transition-all group-hover:scale-110 flex-shrink-0 ${m?"active":""}`,style:{borderRadius:"50%"},children:(0,b.jsx)("svg",{className:`h-4 w-4 transition-transform duration-300 ${m?"":"rotate-180"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",style:{color:"var(--color-text-muted)"},children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),(0,b.jsx)("p",{className:"mb-3 text-sm",style:{color:"var(--color-text-muted)"},children:a.opis}),(0,b.jsxs)("div",{className:`overflow-hidden transition-all duration-300 ease-in-out ${m?"max-h-0 opacity-0":"max-h-[500px] opacity-100"}`,children:[(0,b.jsxs)("div",{className:"mb-3 pl-1",children:[(0,b.jsx)("span",{className:"text-xs font-medium",style:{color:"var(--color-text-muted)"},children:"Ulotka PDF:"}),a.leafletUrl?(0,b.jsxs)("div",{className:"mt-1 flex items-center gap-2 flex-wrap",children:[(0,b.jsxs)("button",{onClick:a=>{a.stopPropagation(),G(!0)},className:"neu-tag text-xs flex items-center gap-1 hover:scale-105 transition-transform",children:[(0,b.jsx)(k.SvgIcon,{name:"file-text",size:14,style:{color:"var(--color-success)"}}),(0,b.jsx)("span",{style:{color:"var(--color-text)"},children:"PokaÅ¼ ulotkÄ™ PDF"})]}),(0,b.jsxs)("button",{onClick:b=>{b.stopPropagation(),i(a.id,void 0)},className:"neu-tag text-xs flex items-center gap-1",title:"Odepnij ulotkÄ™",children:[(0,b.jsx)(k.SvgIcon,{name:"pin-off",size:14,style:{color:"var(--color-error)"}}),(0,b.jsx)("span",{style:{color:"var(--color-text)"},children:"Odepnij"})]})]}):(0,b.jsx)("div",{className:"mt-1",children:z?(0,b.jsxs)("div",{className:"rounded-lg p-3 animate-fadeIn",style:{background:"var(--color-bg-dark)",opacity:.95},onClick:a=>a.stopPropagation(),children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,b.jsx)("span",{className:"text-xs font-bold",style:{color:"var(--color-text)"},children:"Szukaj w bazie MZ:"}),(0,b.jsxs)("button",{onClick:()=>{A(!1),C([]),I("")},className:"neu-tag text-xs flex items-center gap-1",children:[(0,b.jsx)(k.SvgIcon,{name:"x",size:12,style:{color:"var(--color-error)"}}),(0,b.jsx)("span",{style:{color:"var(--color-text)"},children:"Anuluj"})]})]}),(0,b.jsxs)("div",{className:"flex gap-2 mb-2",children:[(0,b.jsx)("input",{type:"text",value:H,onChange:a=>I(a.target.value),onKeyDown:a=>{"Enter"===a.key&&K()},placeholder:"Wpisz nazwÄ™ leku...",className:"neu-input flex-1 text-xs",style:{padding:"0.5rem"}}),(0,b.jsx)("button",{onClick:()=>K(),disabled:H.trim().length<3||D,className:"neu-tag text-xs",children:D?(0,b.jsx)(k.SvgIcon,{name:"loader",size:14}):(0,b.jsx)(k.SvgIcon,{name:"search",size:14,style:{color:"var(--color-text)"}})})]}),D&&(0,b.jsx)("div",{className:"text-xs p-2",style:{color:"var(--color-text-muted)"},children:"Szukanie w Rejestrze ProduktÃ³w Leczniczych..."}),!D&&0===B.length&&H.trim().length>=3&&(0,b.jsxs)("div",{className:"text-xs p-2",style:{color:"var(--color-text-muted)"},children:["Nie znaleziono - sprÃ³buj innÄ… nazwÄ™ lub tylko pierwsze sÅ‚owo.",(0,b.jsx)("br",{}),(0,b.jsx)("span",{style:{fontSize:"0.65rem"},children:"Uwaga: suplementy diety nie sÄ… w Rejestrze ProduktÃ³w Leczniczych."})]}),!D&&B.length>0&&(0,b.jsx)("div",{className:"max-h-40 overflow-y-auto space-y-1.5 p-1 custom-scrollbar",children:B.map(c=>(0,b.jsxs)("button",{onClick:()=>{var b;return b=c.ulotkaUrl,void(i(a.id,b),A(!1),C([]),I(""))},className:"w-full text-left text-xs p-2 rounded transition-colors flex justify-between group neu-tag",children:[(0,b.jsxs)("span",{style:{color:"var(--color-text)"},children:[c.nazwa," ",(0,b.jsxs)("span",{style:{opacity:.7},children:["(",c.moc,c.postac?`, ${c.postac}`:"",")"]})]}),(0,b.jsx)("span",{className:"hidden group-hover:inline",style:{color:"var(--color-accent)"},children:(0,b.jsx)(k.SvgIcon,{name:"plus",size:14})})]},c.id))})]}):(0,b.jsxs)("button",{onClick:b=>{b.stopPropagation(),I(a.nazwa||""),A(!0),C([])},className:"neu-tag text-xs flex items-center gap-1",title:"Wyszukaj ulotkÄ™ w Rejestrze ProduktÃ³w Leczniczych",children:[(0,b.jsx)(k.SvgIcon,{name:"file-search",size:14,style:{color:"var(--color-text)"}}),(0,b.jsx)("span",{style:{color:"var(--color-text)"},children:"ZnajdÅº i podepnij ulotkÄ™"})]})})]}),(0,b.jsxs)("div",{className:"mb-3",children:[(0,b.jsx)("span",{className:"text-xs font-medium",style:{color:"var(--color-text-muted)"},children:"Wskazania:"}),(0,b.jsx)("ul",{className:"mt-1 list-inside list-disc text-sm",style:{color:"var(--color-text)"},children:a.wskazania.map((a,c)=>(0,b.jsx)("li",{children:a},c))})]}),(0,b.jsx)("div",{className:"mb-3 flex flex-wrap gap-1.5 px-1",children:a.tagi.map((a,c)=>(0,b.jsx)("span",{className:"neu-tag text-xs",style:{color:"var(--color-text)",padding:"0.25rem 0.625rem"},children:a},c))})]}),!m&&(0,b.jsx)("div",{className:"mb-4 px-1",children:(0,b.jsx)(l,{selectedLabelIds:a.labels||[],onChange:b=>g(a.id,b),buttonPosition:"right"})}),!m&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"pt-3 mb-3 pr-1",style:{borderTop:"1px solid var(--shadow-dark)"},children:(0,b.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("span",{className:"text-xs font-medium",style:{color:"var(--color-text-muted)"},children:"Notatka:"}),v?(0,b.jsx)("textarea",{value:x,onChange:a=>y(a.target.value),onClick:a=>a.stopPropagation(),className:"neu-input mt-1 text-sm w-full resize-none",style:{padding:"0.5rem",fontSize:"0.875rem",minHeight:"4rem"},placeholder:"Dodaj notatkÄ™...",maxLength:500,autoFocus:!0}):(0,b.jsx)("p",{className:"mt-1 text-sm",style:{color:a.notatka?"var(--color-text)":"var(--color-text-muted)"},children:a.notatka||"Brak notatki"})]}),v?(0,b.jsxs)("div",{className:"flex gap-2 flex-shrink-0",children:[(0,b.jsx)("button",{onClick:b=>{b.stopPropagation(),h(a.id,x.trim()||void 0),w(!1)},className:"neu-tag text-xs",style:{color:"var(--color-success)"},children:"Zapisz"}),(0,b.jsx)("button",{onClick:a=>{a.stopPropagation(),w(!1)},className:"neu-tag text-xs",children:"Anuluj"})]}):(0,b.jsxs)("button",{onClick:b=>{b.stopPropagation(),w(!0),y(a.notatka||"")},className:"neu-tag text-xs flex-shrink-0 flex items-center gap-1 group/btn",style:{color:"var(--color-text)"},children:[(0,b.jsx)(k.SvgIcon,{name:"file-pen-line",size:14}),(0,b.jsx)("span",{className:"group-hover/btn:text-[var(--color-accent)] transition-colors",children:"Edytuj notkÄ™"})]})]})}),(0,b.jsx)("div",{className:"pt-3 pr-1",style:{borderTop:"1px solid var(--shadow-dark)"},children:(0,b.jsxs)("div",{className:"flex items-start justify-between",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-1.5 mb-1",children:[(0,b.jsx)("span",{className:"text-xs font-medium",style:{color:"var(--color-text-muted)"},children:"Termin waÅ¼noÅ›ci:"}),L[J]]}),r?(0,b.jsx)("input",{type:"date",value:t,onChange:a=>u(a.target.value),onClick:a=>a.stopPropagation(),className:"neu-input text-sm",style:{padding:"0.5rem",fontSize:"0.875rem"}}):(0,b.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,b.jsx)("span",{className:"text-sm font-semibold",style:{color:"var(--color-text)"},children:q(a.terminWaznosci)}),(0,b.jsx)("span",{className:"text-xs",style:{color:"var(--color-text-muted)"},children:{expired:"Przeterminowany","expiring-soon":"KoÅ„czy siÄ™ waÅ¼noÅ›Ä‡",valid:"WaÅ¼ny",unknown:"Brak daty"}[J]})]})]}),r?(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)("button",{onClick:b=>{b.stopPropagation(),e(a.id,t||void 0),s(!1)},className:"neu-tag text-xs",style:{color:"var(--color-success)"},children:"Zapisz"}),(0,b.jsx)("button",{onClick:a=>{a.stopPropagation(),s(!1)},className:"neu-tag text-xs",children:"Anuluj"})]}):(0,b.jsxs)("button",{onClick:a=>{a.stopPropagation(),s(!0)},className:"neu-tag text-xs flex items-center gap-1 group/btn",style:{color:"var(--color-text)"},children:[(0,b.jsx)(k.SvgIcon,{name:"calendar-sync",size:14}),(0,b.jsx)("span",{className:"group-hover/btn:text-[var(--color-accent)] transition-colors",children:"Edytuj datÄ™"})]})]})}),(0,b.jsxs)("div",{className:"flex items-center justify-between mt-3 pr-1",children:[(0,b.jsxs)("span",{className:"text-xs",style:{color:"var(--color-text-muted)"},children:["Dodano: ",q(a.dataDodania)]}),(0,b.jsxs)("button",{onClick:b=>{b.stopPropagation(),d(a.id)},className:"neu-tag text-xs hover:scale-105 transition-all flex items-center gap-1 group/del",title:"UsuÅ„ lek","aria-label":"UsuÅ„ lek",children:[(0,b.jsx)(k.SvgIcon,{name:"trash",size:14,style:{color:"var(--color-error)"}}),(0,b.jsx)("span",{className:"group-hover/del:text-[var(--color-error)] transition-colors",style:{color:"var(--color-text)"},children:"UsuÅ„ lek"})]})]})]})]}),F&&a.leafletUrl&&(0,b.jsx)(n,{url:a.leafletUrl,title:a.nazwa||"Ulotka leku",onClose:()=>G(!1)})]})}function s({medicines:a,filters:d,onDelete:e,onUpdateExpiry:f,onUpdateLabels:g,onUpdateNote:h,onUpdateLeaflet:i,totalCount:j,sortBy:l,sortDir:m,onSortChange:n}){let[o,p]=(0,c.useState)("grid"),[q,s]=(0,c.useState)(new Set);(0,c.useEffect)(()=>{let a=localStorage.getItem("medicineListViewMode");("grid"===a||"list"===a)&&p(a)},[]),(0,c.useEffect)(()=>{localStorage.setItem("medicineListViewMode",o)},[o]);let t=a.filter(a=>{if(d.search){let b=d.search.toLowerCase();if(!(a.nazwa?.toLowerCase().includes(b)||a.opis.toLowerCase().includes(b)||a.wskazania.some(a=>a.toLowerCase().includes(b))||a.tagi.some(a=>a.toLowerCase().includes(b))))return!1}if(d.tags.length>0&&!d.tags.every(b=>a.tagi.includes(b)))return!1;if(d.labels.length>0){let b=a.labels||[];if(!d.labels.every(a=>b.includes(a)))return!1}if("all"!==d.expiry){let b=function(a){if(!a)return"unknown";let b=new Date,c=Math.ceil((new Date(a).getTime()-b.getTime())/864e5);return c<0?"expired":c<=30?"expiring-soon":"valid"}(a.terminWaznosci);switch(d.expiry){case"expired":if("expired"!==b)return!1;break;case"expiring-soon":if("expiring-soon"!==b)return!1;break;case"valid":if("valid"!==b)return!1}}return!0}),u=a=>{p(a),s(new Set)};return 0===a.length?(0,b.jsxs)("div",{className:"neu-flat p-12 text-center animate-fadeInUp",children:[(0,b.jsx)("div",{className:"neu-convex w-24 h-24 mx-auto mb-6 flex items-center justify-center animate-popIn",children:(0,b.jsx)(k.SvgIcon,{name:"pill",size:48,style:{color:"var(--color-accent)"}})}),(0,b.jsx)("h2",{className:"mb-2 text-xl font-semibold",style:{color:"var(--color-text)"},children:"Twoja apteczka jest pusta"}),(0,b.jsx)("p",{className:"mb-6",style:{color:"var(--color-text-muted)"},children:"Zaimportuj leki, aby rozpoczÄ…Ä‡ zarzÄ…dzanie apteczkÄ…."}),(0,b.jsxs)("a",{href:"/dodaj",className:"neu-btn neu-btn-primary inline-flex items-center gap-2",children:[(0,b.jsx)(k.SvgIcon,{name:"plus",size:18})," Importuj leki"]})]}):0===t.length?(0,b.jsxs)("div",{className:"neu-flat p-12 text-center animate-fadeInUp",children:[(0,b.jsx)("div",{className:"neu-convex w-24 h-24 mx-auto mb-6 flex items-center justify-center animate-popIn",children:(0,b.jsx)(k.SvgIcon,{name:"search",size:48,style:{color:"var(--color-accent)"}})}),(0,b.jsx)("h2",{className:"mb-2 text-xl font-semibold",style:{color:"var(--color-text)"},children:"Brak wynikÃ³w"}),(0,b.jsx)("p",{style:{color:"var(--color-text-muted)"},children:"Å»aden lek nie pasuje do wybranych filtrÃ³w."})]}):(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"neu-flat-sm flex flex-wrap items-center justify-between gap-3 px-4 py-3 animate-fadeInUp",style:{animationDelay:"0.1s"},children:[(0,b.jsxs)("span",{className:"text-sm font-medium order-last sm:order-first w-full sm:w-auto text-center sm:text-left flex items-center justify-center sm:justify-start gap-1.5",style:{color:"var(--color-text)"},children:[(0,b.jsx)(k.SvgIcon,{name:"package",size:16})," Znaleziono: ",t.length," z ",j," lekÃ³w"]}),(0,b.jsxs)("div",{className:"flex items-center gap-3 mx-auto sm:mx-0",children:[(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)("span",{className:"text-xs",style:{color:"var(--color-text-muted)"},children:"Sortuj:"}),[{key:"nazwa",label:"Nazwa"},{key:"dataDodania",label:"Data"},{key:"terminWaznosci",label:"Termin"}].map(a=>(0,b.jsxs)("button",{onClick:()=>n(a.key),className:`neu-tag text-xs ${l===a.key?"active":""}`,children:[a.label," ",l===a.key&&("asc"===m?"â†‘":"â†“")]},a.key))]}),(0,b.jsx)("div",{className:"w-px h-5 bg-current opacity-20"}),(0,b.jsxs)("div",{className:"flex gap-1",children:[(0,b.jsx)("button",{onClick:()=>u("grid"),className:`neu-tag p-2 transition-all ${"grid"===o?"active":""}`,title:"Widok kafelkÃ³w","aria-label":"Widok kafelkÃ³w","aria-pressed":"grid"===o,children:(0,b.jsx)("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",style:{color:"grid"===o?"white":"var(--color-text-muted)"},children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})})}),(0,b.jsx)("button",{onClick:()=>u("list"),className:`neu-tag p-2 transition-all ${"list"===o?"active":""}`,title:"Widok listy","aria-label":"Widok listy","aria-pressed":"list"===o,children:(0,b.jsx)("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",style:{color:"list"===o?"white":"var(--color-text-muted)"},children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 5h16a1 1 0 011 1v3a1 1 0 01-1 1H4a1 1 0 01-1-1V6a1 1 0 011-1zM4 14h16a1 1 0 011 1v3a1 1 0 01-1 1H4a1 1 0 01-1-1v-3a1 1 0 011-1z"})})})]})]})]}),(0,b.jsx)("div",{className:"grid"===o?"grid gap-5 sm:grid-cols-1 md:grid-cols-2 xl:grid-cols-3":"flex flex-col gap-3",children:t.map((a,c)=>{var d;return(0,b.jsx)("div",{className:"animate-fadeInUp",style:{animationDelay:`${.1+.05*c}s`},children:(0,b.jsx)(r,{medicine:a,onDelete:e,onUpdateExpiry:f,onUpdateLabels:g,onUpdateNote:h,onUpdateLeaflet:i,isCollapsed:(d=a.id,"list"===o?!q.has(d):q.has(d)),onToggleCollapse:()=>{var b;return b=a.id,void s(a=>{let c=new Set(a);return c.has(b)?c.delete(b):c.add(b),c})}})},a.id)})})]})}var t=a.i(71987);function u({onLabelsChange:a}){let[d,e]=(0,c.useState)([]),[g,j]=(0,c.useState)(!1),[k,l]=(0,c.useState)(null),[m,n]=(0,c.useState)(""),[o,p]=(0,c.useState)("green"),[q,r]=(0,c.useState)("");(0,c.useEffect)(()=>{e([])},[]);let s=()=>{e([]),a?.()},t=Object.entries(f.LABEL_COLORS);return(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("span",{className:"text-xs font-medium",style:{color:"var(--color-text-muted)"},children:["Moje etykiety (",d.length,"/",f.MAX_LABELS_GLOBAL,")"]}),!g&&d.length<f.MAX_LABELS_GLOBAL&&(0,b.jsx)("button",{onClick:()=>j(!0),className:"neu-tag text-xs",style:{color:"var(--color-accent)"},children:"+ Dodaj"})]}),g&&(0,b.jsxs)("div",{className:"neu-concave p-3 space-y-2",children:[(0,b.jsx)("input",{type:"text",value:m,onChange:a=>n(a.target.value),placeholder:"Nazwa etykiety...",className:"neu-input text-sm",style:{padding:"0.5rem"},maxLength:20,autoFocus:!0}),(0,b.jsx)("div",{className:"flex flex-wrap gap-1.5",children:t.map(([a,c])=>(0,b.jsx)("button",{onClick:()=>p(a),className:`w-6 h-6 rounded-full transition-all ${o===a?"ring-2 ring-offset-2":""}`,style:{backgroundColor:c.hex,outlineColor:o===a?c.hex:void 0},title:c.name},a))}),q&&(0,b.jsx)("p",{className:"text-xs",style:{color:"var(--color-error)"},children:q}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)("button",{onClick:()=>{(r(""),m.trim())?i(m.trim(),o)?(n(""),p("green"),j(!1),s()):d.length>=f.MAX_LABELS_GLOBAL?r(`Maksymalnie ${f.MAX_LABELS_GLOBAL} etykiet`):r("Etykieta o tej nazwie juÅ¼ istnieje"):r("Nazwa jest wymagana")},className:"neu-tag text-xs",style:{color:"var(--color-success)"},children:"Zapisz"}),(0,b.jsx)("button",{onClick:()=>{j(!1),r(""),n("")},className:"neu-tag text-xs",children:"Anuluj"})]})]}),d.length>0?(0,b.jsx)("div",{className:"flex flex-wrap gap-1.5",children:d.map(a=>(0,b.jsx)("div",{className:"group relative",children:k===a.id?(0,b.jsx)(v,{label:a,onSave:(b,c)=>{var d,e,f;let g,i;return d=a.id,void((e=d,f={name:b,color:c},-1===(i=(g=[]).findIndex(a=>a.id===e))||f.name&&g.find(a=>a.id!==e&&a.name.toLowerCase()===f.name.toLowerCase())?!null:(g[i]={...g[i],...f},h(g),!g[i]))?r("Etykieta o tej nazwie juÅ¼ istnieje"):(l(null),s()))},onCancel:()=>l(null)}):(0,b.jsxs)("span",{className:"neu-label inline-flex items-center gap-1 text-xs px-2 py-1 rounded-full cursor-pointer",style:{backgroundColor:f.LABEL_COLORS[a.color].hex,color:"white"},onClick:()=>l(a.id),title:"Kliknij, aby edytowaÄ‡",children:[a.name,(0,b.jsx)("button",{onClick:b=>{b.stopPropagation(),(a=>{if(confirm("UsunÄ…Ä‡ etykietÄ™? Zostanie usuniÄ™ta ze wszystkich lekÃ³w.")){let b,c;(c=(b=[]).filter(b=>b.id!==a)).length===b.length||h(c),s()}})(a.id)},className:"ml-0.5 opacity-60 hover:opacity-100",children:"Ã—"})]})},a.id))}):!g&&(0,b.jsx)("p",{className:"text-xs",style:{color:"var(--color-text-muted)"},children:"Brak etykiet. Dodaj pierwszÄ… etykietÄ™."})]})}function v({label:a,onSave:d,onCancel:e}){let[g,h]=(0,c.useState)(a.name),[i,j]=(0,c.useState)(a.color),k=Object.entries(f.LABEL_COLORS);return(0,b.jsxs)("div",{className:"neu-concave p-2 space-y-2",style:{minWidth:"150px"},children:[(0,b.jsx)("input",{type:"text",value:g,onChange:a=>h(a.target.value),className:"neu-input text-xs w-full",style:{padding:"0.375rem"},maxLength:20,autoFocus:!0}),(0,b.jsx)("div",{className:"flex flex-wrap gap-1",children:k.map(([a,c])=>(0,b.jsx)("button",{onClick:()=>j(a),className:`w-5 h-5 rounded-full ${i===a?"ring-2 ring-offset-1":""}`,style:{backgroundColor:c.hex}},a))}),(0,b.jsxs)("div",{className:"flex gap-1",children:[(0,b.jsx)("button",{onClick:()=>d(g,i),className:"neu-tag text-xs",style:{color:"var(--color-success)"},children:"âœ“"}),(0,b.jsx)("button",{onClick:e,className:"neu-tag text-xs",children:"âœ•"})]})]})}function w({filters:a,onFiltersChange:d,onExportPDF:e,onCopyList:g,onClearAll:h}){let[i,j]=(0,c.useState)(!0),[l,m]=(0,c.useState)(!0),[n,o]=(0,c.useState)(!0),[p,q]=(0,c.useState)(!1),[r,s]=(0,c.useState)([]),[v,w]=(0,c.useState)({});(0,c.useEffect)(()=>{let a=localStorage.getItem("expiryCollapsed"),b=localStorage.getItem("filtersCollapsed"),c=localStorage.getItem("labelsCollapsed");null!==a&&j("true"===a),null!==b&&m("true"===b),null!==c&&o("true"===c);let d=localStorage.getItem("collapsedCategories");if(d)try{w(JSON.parse(d))}catch{}},[]),(0,c.useEffect)(()=>{localStorage.setItem("expiryCollapsed",String(i))},[i]),(0,c.useEffect)(()=>{localStorage.setItem("filtersCollapsed",String(l))},[l]),(0,c.useEffect)(()=>{localStorage.setItem("labelsCollapsed",String(n))},[n]),(0,c.useEffect)(()=>{localStorage.setItem("collapsedCategories",JSON.stringify(v))},[v]),(0,c.useEffect)(()=>{s([])},[]),(0,c.useEffect)(()=>{let a=()=>{s([])};return window.addEventListener("labelsUpdated",a),()=>window.removeEventListener("labelsUpdated",a)},[]);let x=b=>{let c=a.tags.includes(b)?a.tags.filter(a=>a!==b):[...a.tags,b];d({...a,tags:c})},y=b=>{let c=a.labels.includes(b)?a.labels.filter(a=>a!==b):[...a.labels,b];d({...a,labels:c})},z=a.tags.length>0||a.labels.length>0||a.search||"all"!==a.expiry;return(0,b.jsxs)("div",{className:"neu-flat p-5 space-y-5 animate-fadeInUp",children:[(0,b.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[(0,b.jsxs)("h1",{className:"text-xl font-bold flex items-center gap-2",style:{color:"var(--color-text)"},children:[(0,b.jsx)(t.default,{src:"/icons/twoja_apteczka.png",alt:"Twoja apteczka",width:36,height:36}),"Twoja apteczka"]}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-2",children:[g&&(0,b.jsxs)("button",{onClick:g,className:"neu-btn neu-btn-secondary text-sm",title:"Kopiuj listÄ™ lekÃ³w",children:[(0,b.jsx)(k.SvgIcon,{name:"clipboard-list",size:16,style:{color:"var(--color-text)"}}),"Lista"]}),e&&(0,b.jsxs)("button",{onClick:e,className:"neu-btn neu-btn-secondary text-sm",title:"Eksportuj do PDF",children:[(0,b.jsx)(k.SvgIcon,{name:"file-input",size:16,style:{color:"var(--color-text)"}}),"PDF"]}),h&&(0,b.jsxs)("button",{onClick:()=>{window.confirm("Czy na pewno chcesz wyczyÅ›ciÄ‡ caÅ‚Ä… apteczkÄ™? Tej operacji nie moÅ¼na cofnÄ…Ä‡.")&&h()},className:"neu-btn neu-btn-secondary text-sm flex items-center gap-1 group/clear",title:"WyczyÅ›Ä‡ caÅ‚Ä… apteczkÄ™",children:[(0,b.jsx)(k.SvgIcon,{name:"trash",size:16,style:{color:"var(--color-error)"}}),(0,b.jsx)("span",{className:"group-hover/clear:text-[var(--color-error)] transition-colors",style:{color:"var(--color-text)"},children:"WyczyÅ›Ä‡"})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{htmlFor:"search",className:"mb-2 block text-sm font-medium flex items-center gap-1.5",style:{color:"var(--color-text)"},children:[(0,b.jsx)(k.SvgIcon,{name:"search",size:16})," Szukaj"]}),(0,b.jsx)("input",{type:"text",id:"search",value:a.search,onChange:b=>{var c;return c=b.target.value,void d({...a,search:c})},placeholder:"Nazwa, opis, wskazania...",className:"neu-input",style:{padding:"0.75rem 1rem",fontSize:"0.875rem"}})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"mb-2 flex items-center justify-between cursor-pointer group",onClick:()=>j(!i),role:"button","aria-expanded":!i,children:[(0,b.jsxs)("label",{className:"text-sm font-medium cursor-pointer flex items-center gap-2",style:{color:"var(--color-text)"},children:[(0,b.jsx)(k.SvgIcon,{name:"calendar",size:16})," Termin waÅ¼noÅ›ci",(0,b.jsx)("span",{className:`neu-tag p-1 transition-all group-hover:scale-110 ${!i?"active":""}`,style:{borderRadius:"50%"},children:(0,b.jsx)("svg",{className:"h-3 w-3 transition-transform duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",style:{color:i?"var(--color-text-muted)":"white"},children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:i?"M15 19l-7-7 7-7":"M19 9l-7 7-7-7"})})})]}),i&&"all"!==a.expiry&&(0,b.jsxs)("span",{className:"neu-tag active text-xs flex items-center gap-1",children:["expired"===a.expiry&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(k.SvgIcon,{name:"alert-triangle",size:12})," Przeterminowane"]}),"expiring-soon"===a.expiry&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(k.SvgIcon,{name:"clock",size:12})," KoÅ„czÄ… siÄ™"]}),"valid"===a.expiry&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(k.SvgIcon,{name:"check-circle",size:12})," WaÅ¼ne"]})]})]}),(0,b.jsx)("div",{className:`overflow-hidden transition-all duration-300 ease-in-out ${i?"max-h-0 opacity-0":"max-h-[100px] opacity-100"}`,children:(0,b.jsx)("div",{className:"flex flex-wrap gap-2 pt-2 pb-2",children:[{value:"all",label:"Wszystkie",icon:"clipboard"},{value:"expired",label:"Przeterminowane",icon:"alert-triangle"},{value:"expiring-soon",label:"KoÅ„czÄ… siÄ™",icon:"clock"},{value:"valid",label:"WaÅ¼ne",icon:"check-circle"}].map(c=>(0,b.jsxs)("button",{onClick:b=>{var e;b.stopPropagation(),e=c.value,d({...a,expiry:e})},className:`neu-tag transition-all flex items-center gap-1 ${a.expiry===c.value?"active":""}`,children:[(0,b.jsx)(k.SvgIcon,{name:c.icon,size:14})," ",c.label]},c.value))})})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"mb-2 flex items-center justify-between cursor-pointer group",onClick:()=>m(!l),role:"button","aria-expanded":!l,children:[(0,b.jsxs)("label",{className:"text-sm font-medium cursor-pointer flex items-center gap-2",style:{color:"var(--color-text)"},children:[(0,b.jsx)(k.SvgIcon,{name:"funnel",size:16})," Filtry",(0,b.jsx)("span",{className:`neu-tag p-1 transition-all group-hover:scale-110 ${!l?"active":""}`,style:{borderRadius:"50%"},children:(0,b.jsx)("svg",{className:"h-3 w-3 transition-transform duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",style:{color:l?"var(--color-text-muted)":"white"},children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:l?"M15 19l-7-7 7-7":"M19 9l-7 7-7-7"})})})]}),z&&(0,b.jsx)("button",{onClick:a=>{a.stopPropagation(),d({tags:[],labels:[],search:"",expiry:"all"})},className:"neu-tag text-xs",style:{color:"var(--color-error)"},children:"âœ• WyczyÅ›Ä‡ filtry"})]}),(0,b.jsx)("div",{className:`overflow-hidden transition-all duration-300 ease-in-out ${l?"max-h-0 opacity-0":"max-h-[2000px] opacity-100"}`,children:(0,b.jsx)("div",{className:"space-y-3 py-3 px-2",children:f.TAG_CATEGORIES.map(c=>{let d=v[c.key]??!0,e=c.tags.filter(b=>a.tags.includes(b)).length;return(0,b.jsxs)("div",{className:"mb-2",children:[(0,b.jsxs)("button",{type:"button",onClick:()=>{var a;return a=c.key,void w(b=>({...b,[a]:!b[a]}))},className:`neu-flat-sm w-full flex items-center justify-between text-left py-2 pl-4 pr-3 rounded-xl transition-all duration-200 cursor-pointer select-none ${!d?"active":""}`,children:[(0,b.jsxs)("span",{className:"text-xs font-medium flex items-center gap-1.5",style:{color:d?"var(--color-text-muted)":"white"},children:[(0,b.jsx)("svg",{className:"h-2.5 w-2.5 transition-transform duration-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:d?"M9 5l7 7-7 7":"M19 9l-7 7-7-7"})}),c.label]}),(0,b.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,b.jsx)("span",{className:"text-[10px]",style:{color:"var(--color-text-muted)",opacity:.5},children:c.tags.length}),e>0&&(0,b.jsx)("span",{className:"text-[10px] min-w-[16px] text-center px-1 py-0.5 rounded-full",style:{background:"var(--color-accent)",color:"white"},children:e})]})]}),(0,b.jsx)("div",{className:`overflow-hidden transition-all duration-200 ${d?"max-h-0 opacity-0":"max-h-[500px] opacity-100 mt-2"}`,children:(0,b.jsx)("div",{className:"flex flex-wrap gap-1.5 pl-3 pr-1 py-1",children:c.tags.map(c=>(0,b.jsx)("button",{onClick:()=>x(c),className:`neu-tag text-xs transition-all ${a.tags.includes(c)?"active":""}`,children:c},c))})})]},c.key)})})})]}),(0,b.jsxs)("div",{className:"mt-4",children:[(0,b.jsxs)("div",{className:"mb-2 flex items-center justify-between cursor-pointer group",onClick:()=>o(!n),role:"button","aria-expanded":!n,children:[(0,b.jsxs)("label",{className:"text-sm font-medium cursor-pointer flex items-center gap-2",style:{color:"var(--color-text)"},children:[(0,b.jsx)(k.SvgIcon,{name:"tags",size:16})," Moje etykiety",(0,b.jsx)("span",{className:`neu-tag p-1 transition-all group-hover:scale-110 ${!n?"active":""}`,style:{borderRadius:"50%"},children:(0,b.jsx)("svg",{className:"h-3 w-3 transition-transform duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",style:{color:n?"var(--color-text-muted)":"white"},children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:n?"M15 19l-7-7 7-7":"M19 9l-7 7-7-7"})})})]}),!n&&(0,b.jsxs)("button",{onClick:a=>{a.stopPropagation(),q(!p)},className:"neu-tag text-xs flex items-center gap-1",style:{color:"var(--color-accent)"},children:[(0,b.jsx)(k.SvgIcon,{name:"settings",size:14})," ZarzÄ…dzaj"]})]}),(0,b.jsxs)("div",{className:`overflow-hidden transition-all duration-300 ease-in-out ${n?"max-h-0 opacity-0":"max-h-[500px] opacity-100"}`,children:[p&&(0,b.jsx)("div",{className:"mb-3 neu-concave p-3",children:(0,b.jsx)(u,{onLabelsChange:()=>{s([])}})}),r.length>0?(0,b.jsx)("div",{className:"flex flex-wrap gap-1.5",children:r.map(c=>(0,b.jsx)("button",{onClick:()=>y(c.id),className:`text-xs px-2.5 py-1 rounded-full transition-all ${a.labels.includes(c.id)?"ring-2 ring-offset-1":"opacity-80 hover:opacity-100"}`,style:{backgroundColor:f.LABEL_COLORS[c.color].hex,color:"white"},children:c.name},c.id))}):(0,b.jsx)("p",{className:"text-xs",style:{color:"var(--color-text-muted)"},children:'Brak etykiet. Kliknij "ZarzÄ…dzaj" aby dodaÄ‡.'})]})]}),(a.tags.length>0||a.labels.length>0)&&(0,b.jsxs)("div",{className:"pt-4",style:{borderTop:"1px solid var(--shadow-dark)"},children:[(0,b.jsxs)("span",{className:"text-xs font-medium",style:{color:"var(--color-text-muted)"},children:["Aktywne filtry (",a.tags.length+a.labels.length,"):"]}),(0,b.jsxs)("div",{className:"mt-2 flex flex-wrap gap-1.5",children:[a.tags.map(a=>(0,b.jsxs)("span",{className:"neu-tag active text-xs inline-flex items-center",children:[a,(0,b.jsx)("button",{onClick:()=>x(a),className:"ml-1.5 hover:scale-110 transition-transform","aria-label":`UsuÅ„ filtr ${a}`,children:"Ã—"})]},a)),a.labels.map(a=>{let c=r.find(b=>b.id===a);return c?(0,b.jsxs)("span",{className:"text-xs inline-flex items-center px-2 py-0.5 rounded-full",style:{backgroundColor:f.LABEL_COLORS[c.color].hex,color:"white"},children:[c.name,(0,b.jsx)("button",{onClick:()=>y(a),className:"ml-1.5 hover:scale-110 transition-transform opacity-70 hover:opacity-100","aria-label":`UsuÅ„ etykietÄ™ ${c.name}`,children:"Ã—"})]},a):null})]})]})]})}function x(){let[f,g]=(0,c.useState)([]),[h,i]=(0,c.useState)({tags:[],labels:[],search:"",expiry:"all"}),[j,k]=(0,c.useState)(!1),[l,m]=(0,c.useState)("nazwa"),[n,o]=(0,c.useState)("asc"),[p,q]=(0,c.useState)("idle");(0,c.useEffect)(()=>{g((0,d.getMedicines)()),k(!0);let a=()=>{g((0,d.getMedicines)())};return window.addEventListener("medicinesUpdated",a),()=>window.removeEventListener("medicinesUpdated",a)},[]);let r=(0,c.useMemo)(()=>[...f].sort((a,b)=>{let c=0;switch(l){case"nazwa":let d=(a.nazwa||"zzz").toLowerCase(),e=(b.nazwa||"zzz").toLowerCase();c=d.localeCompare(e,"pl");break;case"dataDodania":c=new Date(a.dataDodania).getTime()-new Date(b.dataDodania).getTime();break;case"terminWaznosci":c=(a.terminWaznosci?new Date(a.terminWaznosci).getTime():1/0)-(b.terminWaznosci?new Date(b.terminWaznosci).getTime():1/0)}return"asc"===n?c:-c}),[f,l,n]),t=async()=>{let{jsPDF:b}=await a.A(52143),c=(await a.A(86089)).default,d=new b,e=a=>{let b={Ä…:"a",Ä‡:"c",Ä™:"e",Å‚:"l",Å„:"n",Ã³:"o",Å›:"s",Åº:"z",Å¼:"z",Ä„:"A",Ä†:"C",Ä˜:"E",Å:"L",Åƒ:"N",Ã“:"O",Åš:"S",Å¹:"Z",Å»:"Z"};return a.replace(/[Ä…Ä‡Ä™Å‚Å„Ã³Å›ÅºÅ¼Ä„Ä†Ä˜ÅÅƒÃ“ÅšÅ¹Å»]/g,a=>b[a]||a)};d.setFontSize(14),d.setTextColor(0),d.text("Moja Apteczka",14,14),d.setFontSize(8),d.setTextColor(80),d.text(`${new Date().toLocaleDateString("pl-PL")}`,60,14),c(d,{startY:20,head:[["Nazwa","Wskazania","Termin","Notatka"]],body:r.map(a=>[e(a.nazwa||"Nieznany"),e(a.wskazania.slice(0,2).join(", ")||"-"),a.terminWaznosci?new Date(a.terminWaznosci).toLocaleDateString("pl-PL"):"-",e(a.notatka||"-")]),styles:{fontSize:7,cellPadding:1.5,lineColor:[0,0,0],lineWidth:.2,textColor:[0,0,0]},headStyles:{fillColor:[255,255,255],textColor:[0,0,0],fontStyle:"bold",cellPadding:2,lineColor:[0,0,0],lineWidth:.3},columnStyles:{0:{cellWidth:35},1:{cellWidth:50},2:{cellWidth:20,halign:"center"},3:{cellWidth:"auto"}},margin:{left:14,right:14,top:10},alternateRowStyles:{fillColor:[255,255,255]}});let f=d.lastAutoTable?.finalY||100;d.setFontSize(6),d.setTextColor(80),d.text("Pudelko na leki - narzedzie informacyjne, nie porada medyczna.",14,f+5),d.save(`apteczka_${new Date().toISOString().split("T")[0]}.pdf`)},u=async()=>{let a=(0,e.generateMedicineList)(r);await (0,e.copyToClipboard)(a)&&(q("copied"),setTimeout(()=>q("idle"),2e3))};return j?(0,b.jsx)("div",{className:"space-y-6",children:(0,b.jsxs)("div",{className:"grid gap-6 lg:grid-cols-[300px_1fr]",children:[f.length>0&&(0,b.jsxs)("aside",{className:"lg:sticky lg:top-28 lg:h-fit",children:[(0,b.jsx)(w,{filters:h,onFiltersChange:i,onExportPDF:t,onCopyList:u,onClearAll:()=>{(0,d.clearMedicines)(),g([])}}),"copied"===p&&(0,b.jsx)("div",{className:"mt-2 neu-flat p-2 text-center text-sm animate-fadeInUp",style:{color:"var(--color-success)"},children:"âœ… Skopiowano listÄ™ lekÃ³w!"})]}),(0,b.jsx)("section",{className:0===f.length?"lg:col-span-2":"",children:(0,b.jsx)(s,{medicines:r,filters:h,onDelete:a=>{confirm("Czy na pewno chcesz usunÄ…Ä‡ ten lek z apteczki?")&&((0,d.deleteMedicine)(a),g((0,d.getMedicines)()))},onUpdateExpiry:(a,b)=>{(0,d.updateMedicine)(a,{terminWaznosci:b}),g((0,d.getMedicines)())},onUpdateLabels:(a,b)=>{(0,d.updateMedicine)(a,{labels:b}),g((0,d.getMedicines)())},onUpdateNote:(a,b)=>{(0,d.updateMedicine)(a,{notatka:b}),g((0,d.getMedicines)())},onUpdateLeaflet:(a,b)=>{(0,d.updateMedicine)(a,{leafletUrl:b}),g((0,d.getMedicines)())},totalCount:f.length,sortBy:l,sortDir:n,onSortChange:a=>{l===a?o(a=>"asc"===a?"desc":"asc"):(m(a),o("asc"))}})})]})}):(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)("div",{className:"neu-skeleton h-12 w-48"}),(0,b.jsx)("div",{className:"grid gap-5 sm:grid-cols-2 lg:grid-cols-3",children:[1,2,3].map(a=>(0,b.jsx)("div",{className:"neu-skeleton h-64"},a))})]})}a.s(["default",()=>x],46940)}];

//# sourceMappingURL=_4336b96d._.js.map