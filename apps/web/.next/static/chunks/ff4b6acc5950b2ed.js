(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,95187,(e,t,a)=>{"use strict";Object.defineProperty(a,"__esModule",{value:!0});var s={callServer:function(){return n.callServer},createServerReference:function(){return o.createServerReference},findSourceMapURL:function(){return r.findSourceMapURL}};for(var l in s)Object.defineProperty(a,l,{enumerable:!0,get:s[l]});let n=e.r(32120),r=e.r(92245),o=e.r(35326)},39798,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(91417),l=e.i(75276),n=e.i(40559),r=e.i(14677);let o="appteczka_labels";function i(){try{let e=localStorage.getItem(o);if(!e)return[];let t=JSON.parse(e);return Array.isArray(t)?t:[]}catch{return console.error("BÅ‚Ä…d odczytu etykiet z localStorage"),[]}}function c(e){try{localStorage.setItem(o,JSON.stringify(e))}catch{console.error("BÅ‚Ä…d zapisu etykiet do localStorage")}}function d(e,t){let a=i();if(a.length>=n.MAX_LABELS_GLOBAL||a.some(t=>t.name.toLowerCase()===e.toLowerCase()))return null;let s={id:(0,r.v4)(),name:e.trim(),color:t};return a.push(s),c(a),s}function x(e){return i().filter(t=>e.includes(t.id))}var m=e.i(81965);function u({selectedLabelIds:e,onChange:s,onLabelsCreated:l,buttonPosition:r="left"}){let[o,c]=(0,a.useState)(!1),[u,p]=(0,a.useState)([]),[h,g]=(0,a.useState)(!1),[v,f]=(0,a.useState)(""),[j,y]=(0,a.useState)("green"),[k,w]=(0,a.useState)(""),b=(0,a.useRef)(null);(0,a.useEffect)(()=>{p(i())},[o]),(0,a.useEffect)(()=>{let e=e=>{b.current&&!b.current.contains(e.target)&&(c(!1),g(!1))};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let N=x(e),z=e.length<n.MAX_LABELS_PER_MEDICINE,S=t=>{e.includes(t)?s(e.filter(e=>e!==t)):z&&s([...e,t])},C=()=>{if(w(""),!v.trim())return void w("Nazwa jest wymagana");if(u.length>=n.MAX_LABELS_GLOBAL)return void w(`Limit ${n.MAX_LABELS_GLOBAL} etykiet`);let t=d(v.trim(),j);t?(p(i()),f(""),y("green"),g(!1),l?.(),window.dispatchEvent(new CustomEvent("labelsUpdated")),z&&s([...e,t.id])):w("Etykieta juÅ¼ istnieje")},L=Object.entries(n.LABEL_COLORS);return(0,t.jsxs)("div",{className:`relative ${"right"===r?"flex flex-wrap items-start justify-between gap-2 pr-1":""}`,ref:b,children:["right"===r&&(0,t.jsx)("div",{className:"flex flex-wrap gap-1 p-1 flex-1 min-h-[28px]",children:N.map(e=>(0,t.jsxs)("span",{className:"inline-flex items-center gap-1 text-xs px-2 py-0.5 rounded-full",style:{backgroundColor:n.LABEL_COLORS[e.color].hex,color:"white",boxShadow:"2px 2px 4px rgba(0,0,0,0.15), -2px -2px 4px rgba(255,255,255,0.1)"},children:[e.name,(0,t.jsx)("button",{onClick:t=>{t.stopPropagation(),S(e.id)},className:"opacity-70 hover:opacity-100",children:"Ã—"})]},e.id))}),(0,t.jsxs)("div",{className:"right"===r?"flex-shrink-0":"",children:[(0,t.jsxs)("button",{onClick:e=>{e.stopPropagation(),c(!o)},className:"neu-tag text-xs flex items-center gap-1",style:{color:"var(--color-text)"},children:[(0,t.jsx)(m.SvgIcon,{name:"tags",size:14,style:{color:"var(--color-accent)"}})," Etykiety",N.length>0&&(0,t.jsx)("span",{className:"ml-1 px-1.5 py-0.5 rounded-full text-white text-xs",style:{backgroundColor:"var(--color-accent)"},children:N.length})]}),o&&(0,t.jsxs)("div",{className:`absolute ${"right"===r?"right-0":"left-0"} bottom-full mb-1 z-[200] neu-flat p-3 pr-4 min-w-[200px] animate-popIn`,onClick:e=>e.stopPropagation(),children:[!z&&(0,t.jsxs)("p",{className:"text-xs mb-2",style:{color:"var(--color-warning)"},children:["Max ",n.MAX_LABELS_PER_MEDICINE," etykiet na lek"]}),u.length>0?(0,t.jsx)("div",{className:"space-y-1.5 mb-2",children:u.map(a=>{let s=e.includes(a.id),l=!s&&!z;return(0,t.jsxs)("button",{onClick:()=>!l&&S(a.id),className:`w-full flex items-center gap-2 px-2 py-1.5 rounded-lg text-left text-xs transition-all ${s?"neu-tag active":"neu-tag"} ${l?"opacity-50 cursor-not-allowed":""}`,disabled:l,children:[(0,t.jsx)("span",{className:"w-3 h-3 rounded-full flex-shrink-0",style:{backgroundColor:n.LABEL_COLORS[a.color].hex}}),(0,t.jsx)("span",{className:s?"text-white":"",children:a.name}),s&&(0,t.jsx)("span",{className:"ml-auto",children:"âœ“"})]},a.id)})}):!h&&(0,t.jsx)("p",{className:"text-xs mb-2",style:{color:"var(--color-text-muted)"},children:"Brak etykiet"}),h?(0,t.jsxs)("div",{className:"space-y-2 pt-2",style:{borderTop:"1px solid var(--shadow-dark)"},children:[(0,t.jsx)("input",{type:"text",value:v,onChange:e=>f(e.target.value),placeholder:"Nazwa...",className:"neu-input text-xs w-full",style:{padding:"0.375rem"},maxLength:20,autoFocus:!0,onKeyDown:e=>"Enter"===e.key&&C()}),(0,t.jsx)("div",{className:"flex flex-wrap gap-1",children:L.map(([e,a])=>(0,t.jsx)("button",{onClick:()=>y(e),className:`w-5 h-5 rounded-full ${j===e?"ring-2 ring-offset-1":""}`,style:{backgroundColor:a.hex},title:a.name},e))}),k&&(0,t.jsx)("p",{className:"text-xs",style:{color:"var(--color-error)"},children:k}),(0,t.jsxs)("div",{className:"flex gap-1",children:[(0,t.jsx)("button",{onClick:C,className:"neu-tag text-xs",style:{color:"var(--color-success)"},children:"Zapisz"}),(0,t.jsx)("button",{onClick:()=>{g(!1),w("")},className:"neu-tag text-xs",children:"Anuluj"})]})]}):u.length<n.MAX_LABELS_GLOBAL&&(0,t.jsx)("button",{onClick:()=>g(!0),className:"w-full neu-tag text-xs mt-1",style:{color:"var(--color-accent)"},children:"+ Nowa etykieta"})]})]}),"left"===r&&N.length>0&&!o&&(0,t.jsx)("div",{className:"flex flex-wrap gap-1 mt-1.5",children:N.map(e=>(0,t.jsxs)("span",{className:"inline-flex items-center gap-1 text-xs px-2 py-0.5 rounded-full",style:{backgroundColor:n.LABEL_COLORS[e.color].hex,color:"white",boxShadow:"2px 2px 4px rgba(0,0,0,0.15), -2px -2px 4px rgba(255,255,255,0.1)"},children:[e.name,(0,t.jsx)("button",{onClick:t=>{t.stopPropagation(),S(e.id)},className:"opacity-70 hover:opacity-100",children:"Ã—"})]},e.id))})]})}var p=e.i(74080);function h({url:e,title:s,onClose:l}){let[n,r]=(0,a.useState)(!1),[o,i]=(0,a.useState)(!1),[c,d]=(0,a.useState)(!0),x=`/api/pdf-proxy?url=${encodeURIComponent(e)}`;if((0,a.useEffect)(()=>(r(!0),document.body.style.overflow="hidden",()=>{document.body.style.overflow=""}),[]),(0,a.useEffect)(()=>{let e=e=>{"Escape"===e.key&&l()};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[l]),(0,a.useEffect)(()=>{(async()=>{try{(await fetch(x,{method:"HEAD"})).ok||i(!0)}catch{i(!0)}finally{d(!1)}})()},[x]),!n)return null;let m=(0,t.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-2 sm:p-4 animate-fadeIn",style:{backgroundColor:"rgba(0, 0, 0, 0.8)",zIndex:9999},onClick:l,children:(0,t.jsxs)("div",{className:"neu-flat w-full max-w-5xl h-[95vh] sm:h-[90vh] flex flex-col animate-popIn",style:{maxHeight:"calc(100vh - 1rem)"},onClick:e=>e.stopPropagation(),children:[(0,t.jsxs)("div",{className:"p-3 sm:p-4 border-b",style:{borderColor:"var(--shadow-dark)"},children:[(0,t.jsxs)("div",{className:"flex items-center justify-between gap-2 mb-2 sm:mb-0",children:[(0,t.jsxs)("h2",{className:"text-sm sm:text-lg font-semibold truncate flex-1",style:{color:"var(--color-text)"},children:["ðŸ“„ ",s]}),(0,t.jsx)("button",{onClick:l,className:"neu-tag text-lg px-3 py-1 flex-shrink-0",style:{color:"var(--color-error)"},title:"Zamknij (Esc)",children:"âœ•"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,t.jsx)("a",{href:e,target:"_blank",rel:"noopener noreferrer",className:"neu-tag text-xs",style:{color:"var(--color-accent)"},children:"ðŸ”— OtwÃ³rz w RPL"}),(0,t.jsx)("a",{href:x,download:`${s}.pdf`,className:"neu-tag text-xs",style:{color:"var(--color-accent)"},children:"ðŸ“¥ Pobierz PDF"})]})]}),(0,t.jsxs)("div",{className:"flex-1 p-2 min-h-0 flex items-center justify-center",children:[c&&(0,t.jsxs)("div",{className:"text-center",style:{color:"var(--color-text-muted)"},children:[(0,t.jsx)("div",{className:"text-2xl mb-2",children:"â³"}),(0,t.jsx)("p",{children:"Åadowanie ulotki..."})]}),!c&&o&&(0,t.jsxs)("div",{className:"text-center p-4",style:{color:"var(--color-text)"},children:[(0,t.jsx)("div",{className:"text-4xl mb-4",children:"ðŸ“„"}),(0,t.jsx)("p",{className:"mb-4",children:"Nie moÅ¼na wyÅ›wietliÄ‡ podglÄ…du ulotki."}),(0,t.jsx)("p",{className:"text-sm mb-4",style:{color:"var(--color-text-muted)"},children:"UÅ¼yj przyciskÃ³w powyÅ¼ej, aby otworzyÄ‡ lub pobraÄ‡ PDF."}),(0,t.jsx)("a",{href:e,target:"_blank",rel:"noopener noreferrer",className:"neu-button inline-block px-6 py-3",style:{color:"var(--color-accent)"},children:"ðŸ”— OtwÃ³rz w Rejestrze MZ"})]}),!c&&!o&&(0,t.jsx)("iframe",{src:x,className:"w-full h-full rounded-lg",style:{backgroundColor:"white",border:"none"},title:s,onError:()=>i(!0)})]})]})});return(0,p.createPortal)(m,document.body)}var g=e.i(95187);let v=(0,g.createServerReference)("409a5b36d98edf6e2d19becca7033c7bd03c5b2984",g.callServer,void 0,g.findSourceMapURL,"searchMedicineInRpl");function f(e){return e?new Date(e).toLocaleDateString("pl-PL"):"Nie ustawiono"}function j({medicine:e,onDelete:s,onUpdateExpiry:l,onUpdateLabels:r,onUpdateNote:o,onUpdateLeaflet:i,isCollapsed:c=!1,onToggleCollapse:d}){let[p,g]=(0,a.useState)(!1),[j,y]=(0,a.useState)(e.terminWaznosci||""),[k,w]=(0,a.useState)(!1),[b,N]=(0,a.useState)(e.notatka||""),[z,S]=(0,a.useState)(!1),[C,L]=(0,a.useState)([]),[E,I]=(0,a.useState)(!1),[A,M]=(0,a.useState)(!1),[P,B]=(0,a.useState)(""),O=function(e){if(!e)return"unknown";let t=new Date,a=Math.ceil((new Date(e).getTime()-t.getTime())/864e5);return a<0?"expired":a<=30?"expiring-soon":"valid"}(e.terminWaznosci),_=async e=>{let t=e||P;if(t&&!(t.trim().length<3)){I(!0);try{let e=await v(t.trim());L(e)}catch(e){console.error("BÅ‚Ä…d wyszukiwania ulotki:",e),L([])}finally{I(!1)}}};t.Fragment,m.SvgIcon,t.Fragment,m.SvgIcon,t.Fragment,m.SvgIcon,t.Fragment,m.SvgIcon;let D={expired:(0,t.jsx)(m.SvgIcon,{name:"alert-triangle",size:16,style:{color:"var(--color-error)"}}),"expiring-soon":(0,t.jsx)(m.SvgIcon,{name:"clock",size:16,style:{color:"var(--color-warning)"}}),valid:(0,t.jsx)(m.SvgIcon,{name:"check-circle",size:16,style:{color:"var(--color-success)"}}),unknown:(0,t.jsx)(m.SvgIcon,{name:"help-circle",size:16,style:{color:"var(--color-text-muted)"}})};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("article",{className:`p-5 rounded-2xl transition-all duration-300 hover:-translate-y-1 glass-dark ${{expired:"neu-status-error","expiring-soon":"neu-status-warning",valid:"neu-status-valid",unknown:"neu-status-unknown"}[O]}`,style:{borderRadius:"20px",overflow:"visible"},children:[(0,t.jsxs)("header",{className:"mb-3 flex items-start justify-between cursor-pointer group",onClick:d,role:"button","aria-expanded":!c,children:[(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-x-3 gap-y-1 flex-1",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold",style:{color:"var(--color-text)"},children:e.nazwa||(0,t.jsx)("span",{className:"italic",style:{color:"var(--color-text-muted)"},children:"Nazwa nieznana"})}),c&&e.labels&&e.labels.length>0&&(0,t.jsx)("div",{className:"flex flex-wrap gap-1 pl-1",children:x(e.labels).map(e=>(0,t.jsx)("span",{className:"inline-flex items-center text-xs px-1.5 py-0.5 rounded-full",style:{backgroundColor:n.LABEL_COLORS[e.color].hex,color:"white",fontSize:"0.65rem",boxShadow:"1px 1px 2px rgba(0,0,0,0.15), -1px -1px 2px rgba(255,255,255,0.1)"},children:e.name},e.id))})]}),(0,t.jsx)("span",{className:`neu-tag p-2 transition-all group-hover:scale-110 flex-shrink-0 ${c?"active":""}`,style:{borderRadius:"50%"},children:(0,t.jsx)("svg",{className:`h-4 w-4 transition-transform duration-300 ${c?"":"rotate-180"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",style:{color:"var(--color-text-muted)"},children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),(0,t.jsx)("p",{className:"mb-3 text-sm",style:{color:"var(--color-text-muted)"},children:e.opis}),(0,t.jsxs)("div",{className:`overflow-hidden transition-all duration-300 ease-in-out ${c?"max-h-0 opacity-0":"max-h-[500px] opacity-100"}`,children:[(0,t.jsxs)("div",{className:"mb-3 pl-1",children:[(0,t.jsx)("span",{className:"text-xs font-medium",style:{color:"var(--color-text-muted)"},children:"Ulotka PDF:"}),e.leafletUrl?(0,t.jsxs)("div",{className:"mt-1 flex items-center gap-2 flex-wrap",children:[(0,t.jsxs)("button",{onClick:e=>{e.stopPropagation(),M(!0)},className:"neu-tag text-xs flex items-center gap-1 hover:scale-105 transition-transform",children:[(0,t.jsx)(m.SvgIcon,{name:"file-text",size:14,style:{color:"var(--color-success)"}}),(0,t.jsx)("span",{style:{color:"var(--color-text)"},children:"PokaÅ¼ ulotkÄ™ PDF"})]}),(0,t.jsxs)("button",{onClick:t=>{t.stopPropagation(),i(e.id,void 0)},className:"neu-tag text-xs flex items-center gap-1",title:"Odepnij ulotkÄ™",children:[(0,t.jsx)(m.SvgIcon,{name:"pin-off",size:14,style:{color:"var(--color-error)"}}),(0,t.jsx)("span",{style:{color:"var(--color-text)"},children:"Odepnij"})]})]}):(0,t.jsx)("div",{className:"mt-1",children:z?(0,t.jsxs)("div",{className:"rounded-lg p-3 animate-fadeIn",style:{background:"var(--color-bg-dark)",opacity:.95},onClick:e=>e.stopPropagation(),children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,t.jsx)("span",{className:"text-xs font-bold",style:{color:"var(--color-text)"},children:"Szukaj w bazie MZ:"}),(0,t.jsxs)("button",{onClick:()=>{S(!1),L([]),B("")},className:"neu-tag text-xs flex items-center gap-1",children:[(0,t.jsx)(m.SvgIcon,{name:"x",size:12,style:{color:"var(--color-error)"}}),(0,t.jsx)("span",{style:{color:"var(--color-text)"},children:"Anuluj"})]})]}),(0,t.jsxs)("div",{className:"flex gap-2 mb-2",children:[(0,t.jsx)("input",{type:"text",value:P,onChange:e=>B(e.target.value),onKeyDown:e=>{"Enter"===e.key&&_()},placeholder:"Wpisz nazwÄ™ leku...",className:"neu-input flex-1 text-xs",style:{padding:"0.5rem"}}),(0,t.jsx)("button",{onClick:()=>_(),disabled:P.trim().length<3||E,className:"neu-tag text-xs",children:E?(0,t.jsx)(m.SvgIcon,{name:"loader",size:14}):(0,t.jsx)(m.SvgIcon,{name:"search",size:14,style:{color:"var(--color-text)"}})})]}),E&&(0,t.jsx)("div",{className:"text-xs p-2",style:{color:"var(--color-text-muted)"},children:"Szukanie w Rejestrze ProduktÃ³w Leczniczych..."}),!E&&0===C.length&&P.trim().length>=3&&(0,t.jsxs)("div",{className:"text-xs p-2",style:{color:"var(--color-text-muted)"},children:["Nie znaleziono - sprÃ³buj innÄ… nazwÄ™ lub tylko pierwsze sÅ‚owo.",(0,t.jsx)("br",{}),(0,t.jsx)("span",{style:{fontSize:"0.65rem"},children:"Uwaga: suplementy diety nie sÄ… w Rejestrze ProduktÃ³w Leczniczych."})]}),!E&&C.length>0&&(0,t.jsx)("div",{className:"max-h-40 overflow-y-auto space-y-1.5 p-1 custom-scrollbar",children:C.map(a=>(0,t.jsxs)("button",{onClick:()=>{var t;return t=a.ulotkaUrl,void(i(e.id,t),S(!1),L([]),B(""))},className:"w-full text-left text-xs p-2 rounded transition-colors flex justify-between group neu-tag",children:[(0,t.jsxs)("span",{style:{color:"var(--color-text)"},children:[a.nazwa," ",(0,t.jsxs)("span",{style:{opacity:.7},children:["(",a.moc,a.postac?`, ${a.postac}`:"",")"]})]}),(0,t.jsx)("span",{className:"hidden group-hover:inline",style:{color:"var(--color-accent)"},children:(0,t.jsx)(m.SvgIcon,{name:"plus",size:14})})]},a.id))})]}):(0,t.jsxs)("button",{onClick:t=>{t.stopPropagation(),B(e.nazwa||""),S(!0),L([])},className:"neu-tag text-xs flex items-center gap-1",title:"Wyszukaj ulotkÄ™ w Rejestrze ProduktÃ³w Leczniczych",children:[(0,t.jsx)(m.SvgIcon,{name:"file-search",size:14,style:{color:"var(--color-text)"}}),(0,t.jsx)("span",{style:{color:"var(--color-text)"},children:"ZnajdÅº i podepnij ulotkÄ™"})]})})]}),(0,t.jsxs)("div",{className:"mb-3",children:[(0,t.jsx)("span",{className:"text-xs font-medium",style:{color:"var(--color-text-muted)"},children:"Wskazania:"}),(0,t.jsx)("ul",{className:"mt-1 list-inside list-disc text-sm",style:{color:"var(--color-text)"},children:e.wskazania.map((e,a)=>(0,t.jsx)("li",{children:e},a))})]}),(0,t.jsx)("div",{className:"mb-3 flex flex-wrap gap-1.5 px-1",children:e.tagi.map((e,a)=>(0,t.jsx)("span",{className:"neu-tag text-xs",style:{color:"var(--color-text)",padding:"0.25rem 0.625rem"},children:e},a))})]}),!c&&(0,t.jsx)("div",{className:"mb-4 px-1",children:(0,t.jsx)(u,{selectedLabelIds:e.labels||[],onChange:t=>r(e.id,t),buttonPosition:"right"})}),!c&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"pt-3 mb-3 pr-1",style:{borderTop:"1px solid var(--shadow-dark)"},children:(0,t.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("span",{className:"text-xs font-medium",style:{color:"var(--color-text-muted)"},children:"Notatka:"}),k?(0,t.jsx)("textarea",{value:b,onChange:e=>N(e.target.value),onClick:e=>e.stopPropagation(),className:"neu-input mt-1 text-sm w-full resize-none",style:{padding:"0.5rem",fontSize:"0.875rem",minHeight:"4rem"},placeholder:"Dodaj notatkÄ™...",maxLength:500,autoFocus:!0}):(0,t.jsx)("p",{className:"mt-1 text-sm",style:{color:e.notatka?"var(--color-text)":"var(--color-text-muted)"},children:e.notatka||"Brak notatki"})]}),k?(0,t.jsxs)("div",{className:"flex gap-2 flex-shrink-0",children:[(0,t.jsx)("button",{onClick:t=>{t.stopPropagation(),o(e.id,b.trim()||void 0),w(!1)},className:"neu-tag text-xs",style:{color:"var(--color-success)"},children:"Zapisz"}),(0,t.jsx)("button",{onClick:e=>{e.stopPropagation(),w(!1)},className:"neu-tag text-xs",children:"Anuluj"})]}):(0,t.jsxs)("button",{onClick:t=>{t.stopPropagation(),w(!0),N(e.notatka||"")},className:"neu-tag text-xs flex-shrink-0 flex items-center gap-1 group/btn",style:{color:"var(--color-text)"},children:[(0,t.jsx)(m.SvgIcon,{name:"file-pen-line",size:14}),(0,t.jsx)("span",{className:"group-hover/btn:text-[var(--color-accent)] transition-colors",children:"Edytuj notkÄ™"})]})]})}),(0,t.jsx)("div",{className:"pt-3 pr-1",style:{borderTop:"1px solid var(--shadow-dark)"},children:(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1.5 mb-1",children:[(0,t.jsx)("span",{className:"text-xs font-medium",style:{color:"var(--color-text-muted)"},children:"Termin waÅ¼noÅ›ci:"}),D[O]]}),p?(0,t.jsx)("input",{type:"date",value:j,onChange:e=>y(e.target.value),onClick:e=>e.stopPropagation(),className:"neu-input text-sm",style:{padding:"0.5rem",fontSize:"0.875rem"}}):(0,t.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,t.jsx)("span",{className:"text-sm font-semibold",style:{color:"var(--color-text)"},children:f(e.terminWaznosci)}),(0,t.jsx)("span",{className:"text-xs",style:{color:"var(--color-text-muted)"},children:{expired:"Przeterminowany","expiring-soon":"KoÅ„czy siÄ™ waÅ¼noÅ›Ä‡",valid:"WaÅ¼ny",unknown:"Brak daty"}[O]})]})]}),p?(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("button",{onClick:t=>{t.stopPropagation(),l(e.id,j||void 0),g(!1)},className:"neu-tag text-xs",style:{color:"var(--color-success)"},children:"Zapisz"}),(0,t.jsx)("button",{onClick:e=>{e.stopPropagation(),g(!1)},className:"neu-tag text-xs",children:"Anuluj"})]}):(0,t.jsxs)("button",{onClick:e=>{e.stopPropagation(),g(!0)},className:"neu-tag text-xs flex items-center gap-1 group/btn",style:{color:"var(--color-text)"},children:[(0,t.jsx)(m.SvgIcon,{name:"calendar-sync",size:14}),(0,t.jsx)("span",{className:"group-hover/btn:text-[var(--color-accent)] transition-colors",children:"Edytuj datÄ™"})]})]})}),(0,t.jsxs)("div",{className:"flex items-center justify-between mt-3 pr-1",children:[(0,t.jsxs)("span",{className:"text-xs",style:{color:"var(--color-text-muted)"},children:["Dodano: ",f(e.dataDodania)]}),(0,t.jsxs)("button",{onClick:t=>{t.stopPropagation(),s(e.id)},className:"neu-tag text-xs hover:scale-105 transition-all flex items-center gap-1 group/del",title:"UsuÅ„ lek","aria-label":"UsuÅ„ lek",children:[(0,t.jsx)(m.SvgIcon,{name:"trash",size:14,style:{color:"var(--color-error)"}}),(0,t.jsx)("span",{className:"group-hover/del:text-[var(--color-error)] transition-colors",style:{color:"var(--color-text)"},children:"UsuÅ„ lek"})]})]})]})]}),A&&e.leafletUrl&&(0,t.jsx)(h,{url:e.leafletUrl,title:e.nazwa||"Ulotka leku",onClose:()=>M(!1)})]})}function y({medicines:e,filters:s,onDelete:l,onUpdateExpiry:n,onUpdateLabels:r,onUpdateNote:o,onUpdateLeaflet:i,totalCount:c,sortBy:d,sortDir:x,onSortChange:u}){let[p,h]=(0,a.useState)("grid"),[g,v]=(0,a.useState)(new Set);(0,a.useEffect)(()=>{let e=localStorage.getItem("medicineListViewMode");("grid"===e||"list"===e)&&h(e)},[]),(0,a.useEffect)(()=>{localStorage.setItem("medicineListViewMode",p)},[p]);let f=e.filter(e=>{if(s.search){let t=s.search.toLowerCase();if(!(e.nazwa?.toLowerCase().includes(t)||e.opis.toLowerCase().includes(t)||e.wskazania.some(e=>e.toLowerCase().includes(t))||e.tagi.some(e=>e.toLowerCase().includes(t))))return!1}if(s.tags.length>0&&!s.tags.every(t=>e.tagi.includes(t)))return!1;if(s.labels.length>0){let t=e.labels||[];if(!s.labels.every(e=>t.includes(e)))return!1}if("all"!==s.expiry){let t=function(e){if(!e)return"unknown";let t=new Date,a=Math.ceil((new Date(e).getTime()-t.getTime())/864e5);return a<0?"expired":a<=30?"expiring-soon":"valid"}(e.terminWaznosci);switch(s.expiry){case"expired":if("expired"!==t)return!1;break;case"expiring-soon":if("expiring-soon"!==t)return!1;break;case"valid":if("valid"!==t)return!1}}return!0}),y=e=>{h(e),v(new Set)};return 0===e.length?(0,t.jsxs)("div",{className:"neu-flat p-12 text-center animate-fadeInUp",children:[(0,t.jsx)("div",{className:"neu-convex w-24 h-24 mx-auto mb-6 flex items-center justify-center animate-popIn",children:(0,t.jsx)(m.SvgIcon,{name:"pill",size:48,style:{color:"var(--color-accent)"}})}),(0,t.jsx)("h2",{className:"mb-2 text-xl font-semibold",style:{color:"var(--color-text)"},children:"Twoja apteczka jest pusta"}),(0,t.jsx)("p",{className:"mb-6",style:{color:"var(--color-text-muted)"},children:"Zaimportuj leki, aby rozpoczÄ…Ä‡ zarzÄ…dzanie apteczkÄ…."}),(0,t.jsxs)("a",{href:"/dodaj",className:"neu-btn neu-btn-primary inline-flex items-center gap-2",children:[(0,t.jsx)(m.SvgIcon,{name:"plus",size:18})," Importuj leki"]})]}):0===f.length?(0,t.jsxs)("div",{className:"neu-flat p-12 text-center animate-fadeInUp",children:[(0,t.jsx)("div",{className:"neu-convex w-24 h-24 mx-auto mb-6 flex items-center justify-center animate-popIn",children:(0,t.jsx)(m.SvgIcon,{name:"search",size:48,style:{color:"var(--color-accent)"}})}),(0,t.jsx)("h2",{className:"mb-2 text-xl font-semibold",style:{color:"var(--color-text)"},children:"Brak wynikÃ³w"}),(0,t.jsx)("p",{style:{color:"var(--color-text-muted)"},children:"Å»aden lek nie pasuje do wybranych filtrÃ³w."})]}):(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"neu-flat-sm flex flex-wrap items-center justify-between gap-3 px-4 py-3 animate-fadeInUp",style:{animationDelay:"0.1s"},children:[(0,t.jsxs)("span",{className:"text-sm font-medium order-last sm:order-first w-full sm:w-auto text-center sm:text-left flex items-center justify-center sm:justify-start gap-1.5",style:{color:"var(--color-text)"},children:[(0,t.jsx)(m.SvgIcon,{name:"package",size:16})," Znaleziono: ",f.length," z ",c," lekÃ³w"]}),(0,t.jsxs)("div",{className:"flex items-center gap-3 mx-auto sm:mx-0",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)("span",{className:"text-xs",style:{color:"var(--color-text-muted)"},children:"Sortuj:"}),[{key:"nazwa",label:"Nazwa"},{key:"dataDodania",label:"Data"},{key:"terminWaznosci",label:"Termin"}].map(e=>(0,t.jsxs)("button",{onClick:()=>u(e.key),className:`neu-tag text-xs ${d===e.key?"active":""}`,children:[e.label," ",d===e.key&&("asc"===x?"â†‘":"â†“")]},e.key))]}),(0,t.jsx)("div",{className:"w-px h-5 bg-current opacity-20"}),(0,t.jsxs)("div",{className:"flex gap-1",children:[(0,t.jsx)("button",{onClick:()=>y("grid"),className:`neu-tag p-2 transition-all ${"grid"===p?"active":""}`,title:"Widok kafelkÃ³w","aria-label":"Widok kafelkÃ³w","aria-pressed":"grid"===p,children:(0,t.jsx)("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",style:{color:"grid"===p?"white":"var(--color-text-muted)"},children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})})}),(0,t.jsx)("button",{onClick:()=>y("list"),className:`neu-tag p-2 transition-all ${"list"===p?"active":""}`,title:"Widok listy","aria-label":"Widok listy","aria-pressed":"list"===p,children:(0,t.jsx)("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",style:{color:"list"===p?"white":"var(--color-text-muted)"},children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 5h16a1 1 0 011 1v3a1 1 0 01-1 1H4a1 1 0 01-1-1V6a1 1 0 011-1zM4 14h16a1 1 0 011 1v3a1 1 0 01-1 1H4a1 1 0 01-1-1v-3a1 1 0 011-1z"})})})]})]})]}),(0,t.jsx)("div",{className:"grid"===p?"grid gap-5 sm:grid-cols-1 md:grid-cols-2 xl:grid-cols-3":"flex flex-col gap-3",children:f.map((e,a)=>{var s;return(0,t.jsx)("div",{className:"animate-fadeInUp",style:{animationDelay:`${.1+.05*a}s`},children:(0,t.jsx)(j,{medicine:e,onDelete:l,onUpdateExpiry:n,onUpdateLabels:r,onUpdateNote:o,onUpdateLeaflet:i,isCollapsed:(s=e.id,"list"===p?!g.has(s):g.has(s)),onToggleCollapse:()=>{var t;return t=e.id,void v(e=>{let a=new Set(e);return a.has(t)?a.delete(t):a.add(t),a})}})},e.id)})})]})}var k=e.i(57688);function w({onLabelsChange:e}){let[s,l]=(0,a.useState)([]),[r,o]=(0,a.useState)(!1),[x,m]=(0,a.useState)(null),[u,p]=(0,a.useState)(""),[h,g]=(0,a.useState)("green"),[v,f]=(0,a.useState)("");(0,a.useEffect)(()=>{l(i())},[]);let j=()=>{l(i()),e?.()},y=Object.entries(n.LABEL_COLORS);return(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("span",{className:"text-xs font-medium",style:{color:"var(--color-text-muted)"},children:["Moje etykiety (",s.length,"/",n.MAX_LABELS_GLOBAL,")"]}),!r&&s.length<n.MAX_LABELS_GLOBAL&&(0,t.jsx)("button",{onClick:()=>o(!0),className:"neu-tag text-xs",style:{color:"var(--color-accent)"},children:"+ Dodaj"})]}),r&&(0,t.jsxs)("div",{className:"neu-concave p-3 space-y-2",children:[(0,t.jsx)("input",{type:"text",value:u,onChange:e=>p(e.target.value),placeholder:"Nazwa etykiety...",className:"neu-input text-sm",style:{padding:"0.5rem"},maxLength:20,autoFocus:!0}),(0,t.jsx)("div",{className:"flex flex-wrap gap-1.5",children:y.map(([e,a])=>(0,t.jsx)("button",{onClick:()=>g(e),className:`w-6 h-6 rounded-full transition-all ${h===e?"ring-2 ring-offset-2":""}`,style:{backgroundColor:a.hex,outlineColor:h===e?a.hex:void 0},title:a.name},e))}),v&&(0,t.jsx)("p",{className:"text-xs",style:{color:"var(--color-error)"},children:v}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("button",{onClick:()=>{(f(""),u.trim())?d(u.trim(),h)?(p(""),g("green"),o(!1),j()):s.length>=n.MAX_LABELS_GLOBAL?f(`Maksymalnie ${n.MAX_LABELS_GLOBAL} etykiet`):f("Etykieta o tej nazwie juÅ¼ istnieje"):f("Nazwa jest wymagana")},className:"neu-tag text-xs",style:{color:"var(--color-success)"},children:"Zapisz"}),(0,t.jsx)("button",{onClick:()=>{o(!1),f(""),p("")},className:"neu-tag text-xs",children:"Anuluj"})]})]}),s.length>0?(0,t.jsx)("div",{className:"flex flex-wrap gap-1.5",children:s.map(e=>(0,t.jsx)("div",{className:"group relative",children:x===e.id?(0,t.jsx)(b,{label:e,onSave:(t,a)=>{var s,l,n;let r,o;return s=e.id,void((l=s,n={name:t,color:a},-1===(o=(r=i()).findIndex(e=>e.id===l))||n.name&&r.find(e=>e.id!==l&&e.name.toLowerCase()===n.name.toLowerCase())?!null:(r[o]={...r[o],...n},c(r),!r[o]))?f("Etykieta o tej nazwie juÅ¼ istnieje"):(m(null),j()))},onCancel:()=>m(null)}):(0,t.jsxs)("span",{className:"neu-label inline-flex items-center gap-1 text-xs px-2 py-1 rounded-full cursor-pointer",style:{backgroundColor:n.LABEL_COLORS[e.color].hex,color:"white"},onClick:()=>m(e.id),title:"Kliknij, aby edytowaÄ‡",children:[e.name,(0,t.jsx)("button",{onClick:t=>{t.stopPropagation(),(e=>{if(confirm("UsunÄ…Ä‡ etykietÄ™? Zostanie usuniÄ™ta ze wszystkich lekÃ³w.")){let t,a;(a=(t=i()).filter(t=>t.id!==e)).length===t.length||(c(a),function(e){try{let t=localStorage.getItem("appteczka_medicines");if(!t)return;let a=JSON.parse(t);if(!a.leki||!Array.isArray(a.leki))return;let s=!1;for(let t of a.leki)if(t.labels&&Array.isArray(t.labels)){let a=t.labels.length;t.labels=t.labels.filter(t=>t!==e),t.labels.length!==a&&(s=!0)}s&&(localStorage.setItem("appteczka_medicines",JSON.stringify(a)),window.dispatchEvent(new Event("medicinesUpdated")))}catch(e){console.error("BÅ‚Ä…d usuwania etykiety z lekÃ³w:",e)}}(e)),j()}})(e.id)},className:"ml-0.5 opacity-60 hover:opacity-100",children:"Ã—"})]})},e.id))}):!r&&(0,t.jsx)("p",{className:"text-xs",style:{color:"var(--color-text-muted)"},children:"Brak etykiet. Dodaj pierwszÄ… etykietÄ™."})]})}function b({label:e,onSave:s,onCancel:l}){let[r,o]=(0,a.useState)(e.name),[i,c]=(0,a.useState)(e.color),d=Object.entries(n.LABEL_COLORS);return(0,t.jsxs)("div",{className:"neu-concave p-2 space-y-2",style:{minWidth:"150px"},children:[(0,t.jsx)("input",{type:"text",value:r,onChange:e=>o(e.target.value),className:"neu-input text-xs w-full",style:{padding:"0.375rem"},maxLength:20,autoFocus:!0}),(0,t.jsx)("div",{className:"flex flex-wrap gap-1",children:d.map(([e,a])=>(0,t.jsx)("button",{onClick:()=>c(e),className:`w-5 h-5 rounded-full ${i===e?"ring-2 ring-offset-1":""}`,style:{backgroundColor:a.hex}},e))}),(0,t.jsxs)("div",{className:"flex gap-1",children:[(0,t.jsx)("button",{onClick:()=>s(r,i),className:"neu-tag text-xs",style:{color:"var(--color-success)"},children:"âœ“"}),(0,t.jsx)("button",{onClick:l,className:"neu-tag text-xs",children:"âœ•"})]})]})}function N({filters:e,onFiltersChange:s,onExportPDF:l,onCopyList:r,onClearAll:o}){let[c,d]=(0,a.useState)(!0),[x,u]=(0,a.useState)(!0),[p,h]=(0,a.useState)(!0),[g,v]=(0,a.useState)(!1),[f,j]=(0,a.useState)([]),[y,b]=(0,a.useState)({});(0,a.useEffect)(()=>{let e=localStorage.getItem("expiryCollapsed"),t=localStorage.getItem("filtersCollapsed"),a=localStorage.getItem("labelsCollapsed");null!==e&&d("true"===e),null!==t&&u("true"===t),null!==a&&h("true"===a);let s=localStorage.getItem("collapsedCategories");if(s)try{b(JSON.parse(s))}catch{}},[]),(0,a.useEffect)(()=>{localStorage.setItem("expiryCollapsed",String(c))},[c]),(0,a.useEffect)(()=>{localStorage.setItem("filtersCollapsed",String(x))},[x]),(0,a.useEffect)(()=>{localStorage.setItem("labelsCollapsed",String(p))},[p]),(0,a.useEffect)(()=>{localStorage.setItem("collapsedCategories",JSON.stringify(y))},[y]),(0,a.useEffect)(()=>{j(i())},[]),(0,a.useEffect)(()=>{let e=()=>{j(i())};return window.addEventListener("labelsUpdated",e),()=>window.removeEventListener("labelsUpdated",e)},[]);let N=t=>{let a=e.tags.includes(t)?e.tags.filter(e=>e!==t):[...e.tags,t];s({...e,tags:a})},z=t=>{let a=e.labels.includes(t)?e.labels.filter(e=>e!==t):[...e.labels,t];s({...e,labels:a})},S=e.tags.length>0||e.labels.length>0||e.search||"all"!==e.expiry;return(0,t.jsxs)("div",{className:"neu-flat p-5 space-y-5 animate-fadeInUp",children:[(0,t.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[(0,t.jsxs)("h1",{className:"text-xl font-bold flex items-center gap-2",style:{color:"var(--color-text)"},children:[(0,t.jsx)(k.default,{src:"/icons/twoja_apteczka.png",alt:"Twoja apteczka",width:36,height:36}),"Twoja apteczka"]}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-2",children:[r&&(0,t.jsxs)("button",{onClick:r,className:"neu-btn neu-btn-secondary text-sm",title:"Kopiuj listÄ™ lekÃ³w",children:[(0,t.jsx)(m.SvgIcon,{name:"clipboard-list",size:16,style:{color:"var(--color-text)"}}),"Lista"]}),l&&(0,t.jsxs)("button",{onClick:l,className:"neu-btn neu-btn-secondary text-sm",title:"Eksportuj do PDF",children:[(0,t.jsx)(m.SvgIcon,{name:"file-input",size:16,style:{color:"var(--color-text)"}}),"PDF"]}),o&&(0,t.jsxs)("button",{onClick:()=>{window.confirm("Czy na pewno chcesz wyczyÅ›ciÄ‡ caÅ‚Ä… apteczkÄ™? Tej operacji nie moÅ¼na cofnÄ…Ä‡.")&&o()},className:"neu-btn neu-btn-secondary text-sm flex items-center gap-1 group/clear",title:"WyczyÅ›Ä‡ caÅ‚Ä… apteczkÄ™",children:[(0,t.jsx)(m.SvgIcon,{name:"trash",size:16,style:{color:"var(--color-error)"}}),(0,t.jsx)("span",{className:"group-hover/clear:text-[var(--color-error)] transition-colors",style:{color:"var(--color-text)"},children:"WyczyÅ›Ä‡"})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:"search",className:"mb-2 block text-sm font-medium flex items-center gap-1.5",style:{color:"var(--color-text)"},children:[(0,t.jsx)(m.SvgIcon,{name:"search",size:16})," Szukaj"]}),(0,t.jsx)("input",{type:"text",id:"search",value:e.search,onChange:t=>{var a;return a=t.target.value,void s({...e,search:a})},placeholder:"Nazwa, opis, wskazania...",className:"neu-input",style:{padding:"0.75rem 1rem",fontSize:"0.875rem"}})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"mb-2 flex items-center justify-between cursor-pointer group",onClick:()=>d(!c),role:"button","aria-expanded":!c,children:[(0,t.jsxs)("label",{className:"text-sm font-medium cursor-pointer flex items-center gap-2",style:{color:"var(--color-text)"},children:[(0,t.jsx)(m.SvgIcon,{name:"calendar",size:16})," Termin waÅ¼noÅ›ci",(0,t.jsx)("span",{className:`neu-tag p-1 transition-all group-hover:scale-110 ${!c?"active":""}`,style:{borderRadius:"50%"},children:(0,t.jsx)("svg",{className:"h-3 w-3 transition-transform duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",style:{color:c?"var(--color-text-muted)":"white"},children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:c?"M15 19l-7-7 7-7":"M19 9l-7 7-7-7"})})})]}),c&&"all"!==e.expiry&&(0,t.jsxs)("span",{className:"neu-tag active text-xs flex items-center gap-1",children:["expired"===e.expiry&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(m.SvgIcon,{name:"alert-triangle",size:12})," Przeterminowane"]}),"expiring-soon"===e.expiry&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(m.SvgIcon,{name:"clock",size:12})," KoÅ„czÄ… siÄ™"]}),"valid"===e.expiry&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(m.SvgIcon,{name:"check-circle",size:12})," WaÅ¼ne"]})]})]}),(0,t.jsx)("div",{className:`overflow-hidden transition-all duration-300 ease-in-out ${c?"max-h-0 opacity-0":"max-h-[100px] opacity-100"}`,children:(0,t.jsx)("div",{className:"flex flex-wrap gap-2 pt-2 pb-2",children:[{value:"all",label:"Wszystkie",icon:"clipboard"},{value:"expired",label:"Przeterminowane",icon:"alert-triangle"},{value:"expiring-soon",label:"KoÅ„czÄ… siÄ™",icon:"clock"},{value:"valid",label:"WaÅ¼ne",icon:"check-circle"}].map(a=>(0,t.jsxs)("button",{onClick:t=>{var l;t.stopPropagation(),l=a.value,s({...e,expiry:l})},className:`neu-tag transition-all flex items-center gap-1 ${e.expiry===a.value?"active":""}`,children:[(0,t.jsx)(m.SvgIcon,{name:a.icon,size:14})," ",a.label]},a.value))})})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"mb-2 flex items-center justify-between cursor-pointer group",onClick:()=>u(!x),role:"button","aria-expanded":!x,children:[(0,t.jsxs)("label",{className:"text-sm font-medium cursor-pointer flex items-center gap-2",style:{color:"var(--color-text)"},children:[(0,t.jsx)(m.SvgIcon,{name:"funnel",size:16})," Filtry",(0,t.jsx)("span",{className:`neu-tag p-1 transition-all group-hover:scale-110 ${!x?"active":""}`,style:{borderRadius:"50%"},children:(0,t.jsx)("svg",{className:"h-3 w-3 transition-transform duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",style:{color:x?"var(--color-text-muted)":"white"},children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:x?"M15 19l-7-7 7-7":"M19 9l-7 7-7-7"})})})]}),S&&(0,t.jsx)("button",{onClick:e=>{e.stopPropagation(),s({tags:[],labels:[],search:"",expiry:"all"})},className:"neu-tag text-xs",style:{color:"var(--color-error)"},children:"âœ• WyczyÅ›Ä‡ filtry"})]}),(0,t.jsx)("div",{className:`overflow-hidden transition-all duration-300 ease-in-out ${x?"max-h-0 opacity-0":"max-h-[2000px] opacity-100"}`,children:(0,t.jsx)("div",{className:"space-y-3 py-3 px-2",children:n.TAG_CATEGORIES.map(a=>{let s=y[a.key]??!0,l=a.tags.filter(t=>e.tags.includes(t)).length;return(0,t.jsxs)("div",{className:"mb-2",children:[(0,t.jsxs)("button",{type:"button",onClick:()=>{var e;return e=a.key,void b(t=>({...t,[e]:!t[e]}))},className:`neu-flat-sm w-full flex items-center justify-between text-left py-2 pl-4 pr-3 rounded-xl transition-all duration-200 cursor-pointer select-none ${!s?"active":""}`,children:[(0,t.jsxs)("span",{className:"text-xs font-medium flex items-center gap-1.5",style:{color:s?"var(--color-text-muted)":"white"},children:[(0,t.jsx)("svg",{className:"h-2.5 w-2.5 transition-transform duration-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:s?"M9 5l7 7-7 7":"M19 9l-7 7-7-7"})}),a.label]}),(0,t.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,t.jsx)("span",{className:"text-[10px]",style:{color:"var(--color-text-muted)",opacity:.5},children:a.tags.length}),l>0&&(0,t.jsx)("span",{className:"text-[10px] min-w-[16px] text-center px-1 py-0.5 rounded-full",style:{background:"var(--color-accent)",color:"white"},children:l})]})]}),(0,t.jsx)("div",{className:`overflow-hidden transition-all duration-200 ${s?"max-h-0 opacity-0":"max-h-[500px] opacity-100 mt-2"}`,children:(0,t.jsx)("div",{className:"flex flex-wrap gap-1.5 pl-3 pr-1 py-1",children:a.tags.map(a=>(0,t.jsx)("button",{onClick:()=>N(a),className:`neu-tag text-xs transition-all ${e.tags.includes(a)?"active":""}`,children:a},a))})})]},a.key)})})})]}),(0,t.jsxs)("div",{className:"mt-4",children:[(0,t.jsxs)("div",{className:"mb-2 flex items-center justify-between cursor-pointer group",onClick:()=>h(!p),role:"button","aria-expanded":!p,children:[(0,t.jsxs)("label",{className:"text-sm font-medium cursor-pointer flex items-center gap-2",style:{color:"var(--color-text)"},children:[(0,t.jsx)(m.SvgIcon,{name:"tags",size:16})," Moje etykiety",(0,t.jsx)("span",{className:`neu-tag p-1 transition-all group-hover:scale-110 ${!p?"active":""}`,style:{borderRadius:"50%"},children:(0,t.jsx)("svg",{className:"h-3 w-3 transition-transform duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",style:{color:p?"var(--color-text-muted)":"white"},children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:p?"M15 19l-7-7 7-7":"M19 9l-7 7-7-7"})})})]}),!p&&(0,t.jsxs)("button",{onClick:e=>{e.stopPropagation(),v(!g)},className:"neu-tag text-xs flex items-center gap-1",style:{color:"var(--color-accent)"},children:[(0,t.jsx)(m.SvgIcon,{name:"settings",size:14})," ZarzÄ…dzaj"]})]}),(0,t.jsxs)("div",{className:`overflow-hidden transition-all duration-300 ease-in-out ${p?"max-h-0 opacity-0":"max-h-[500px] opacity-100"}`,children:[g&&(0,t.jsx)("div",{className:"mb-3 neu-concave p-3",children:(0,t.jsx)(w,{onLabelsChange:()=>{j(i())}})}),f.length>0?(0,t.jsx)("div",{className:"flex flex-wrap gap-1.5",children:f.map(a=>(0,t.jsx)("button",{onClick:()=>z(a.id),className:`text-xs px-2.5 py-1 rounded-full transition-all ${e.labels.includes(a.id)?"ring-2 ring-offset-1":"opacity-80 hover:opacity-100"}`,style:{backgroundColor:n.LABEL_COLORS[a.color].hex,color:"white"},children:a.name},a.id))}):(0,t.jsx)("p",{className:"text-xs",style:{color:"var(--color-text-muted)"},children:'Brak etykiet. Kliknij "ZarzÄ…dzaj" aby dodaÄ‡.'})]})]}),(e.tags.length>0||e.labels.length>0)&&(0,t.jsxs)("div",{className:"pt-4",style:{borderTop:"1px solid var(--shadow-dark)"},children:[(0,t.jsxs)("span",{className:"text-xs font-medium",style:{color:"var(--color-text-muted)"},children:["Aktywne filtry (",e.tags.length+e.labels.length,"):"]}),(0,t.jsxs)("div",{className:"mt-2 flex flex-wrap gap-1.5",children:[e.tags.map(e=>(0,t.jsxs)("span",{className:"neu-tag active text-xs inline-flex items-center",children:[e,(0,t.jsx)("button",{onClick:()=>N(e),className:"ml-1.5 hover:scale-110 transition-transform","aria-label":`UsuÅ„ filtr ${e}`,children:"Ã—"})]},e)),e.labels.map(e=>{let a=f.find(t=>t.id===e);return a?(0,t.jsxs)("span",{className:"text-xs inline-flex items-center px-2 py-0.5 rounded-full",style:{backgroundColor:n.LABEL_COLORS[a.color].hex,color:"white"},children:[a.name,(0,t.jsx)("button",{onClick:()=>z(e),className:"ml-1.5 hover:scale-110 transition-transform opacity-70 hover:opacity-100","aria-label":`UsuÅ„ etykietÄ™ ${a.name}`,children:"Ã—"})]},e):null})]})]})]})}function z(){let[n,r]=(0,a.useState)([]),[o,i]=(0,a.useState)({tags:[],labels:[],search:"",expiry:"all"}),[c,d]=(0,a.useState)(!1),[x,m]=(0,a.useState)("nazwa"),[u,p]=(0,a.useState)("asc"),[h,g]=(0,a.useState)("idle");(0,a.useEffect)(()=>{r((0,s.getMedicines)()),d(!0);let e=()=>{r((0,s.getMedicines)())};return window.addEventListener("medicinesUpdated",e),()=>window.removeEventListener("medicinesUpdated",e)},[]);let v=(0,a.useMemo)(()=>[...n].sort((e,t)=>{let a=0;switch(x){case"nazwa":let s=(e.nazwa||"zzz").toLowerCase(),l=(t.nazwa||"zzz").toLowerCase();a=s.localeCompare(l,"pl");break;case"dataDodania":a=new Date(e.dataDodania).getTime()-new Date(t.dataDodania).getTime();break;case"terminWaznosci":a=(e.terminWaznosci?new Date(e.terminWaznosci).getTime():1/0)-(t.terminWaznosci?new Date(t.terminWaznosci).getTime():1/0)}return"asc"===u?a:-a}),[n,x,u]),f=async()=>{let{jsPDF:t}=await e.A(34162),a=(await e.A(98136)).default,s=new t,l=e=>{let t={Ä…:"a",Ä‡:"c",Ä™:"e",Å‚:"l",Å„:"n",Ã³:"o",Å›:"s",Åº:"z",Å¼:"z",Ä„:"A",Ä†:"C",Ä˜:"E",Å:"L",Åƒ:"N",Ã“:"O",Åš:"S",Å¹:"Z",Å»:"Z"};return e.replace(/[Ä…Ä‡Ä™Å‚Å„Ã³Å›ÅºÅ¼Ä„Ä†Ä˜ÅÅƒÃ“ÅšÅ¹Å»]/g,e=>t[e]||e)};s.setFontSize(14),s.setTextColor(0),s.text("Moja Apteczka",14,14),s.setFontSize(8),s.setTextColor(80),s.text(`${new Date().toLocaleDateString("pl-PL")}`,60,14),a(s,{startY:20,head:[["Nazwa","Wskazania","Termin","Notatka"]],body:v.map(e=>[l(e.nazwa||"Nieznany"),l(e.wskazania.slice(0,2).join(", ")||"-"),e.terminWaznosci?new Date(e.terminWaznosci).toLocaleDateString("pl-PL"):"-",l(e.notatka||"-")]),styles:{fontSize:7,cellPadding:1.5,lineColor:[0,0,0],lineWidth:.2,textColor:[0,0,0]},headStyles:{fillColor:[255,255,255],textColor:[0,0,0],fontStyle:"bold",cellPadding:2,lineColor:[0,0,0],lineWidth:.3},columnStyles:{0:{cellWidth:35},1:{cellWidth:50},2:{cellWidth:20,halign:"center"},3:{cellWidth:"auto"}},margin:{left:14,right:14,top:10},alternateRowStyles:{fillColor:[255,255,255]}});let n=s.lastAutoTable?.finalY||100;s.setFontSize(6),s.setTextColor(80),s.text("Pudelko na leki - narzedzie informacyjne, nie porada medyczna.",14,n+5),s.save(`apteczka_${new Date().toISOString().split("T")[0]}.pdf`)},j=async()=>{let e=(0,l.generateMedicineList)(v);await (0,l.copyToClipboard)(e)&&(g("copied"),setTimeout(()=>g("idle"),2e3))};return c?(0,t.jsx)("div",{className:"space-y-6",children:(0,t.jsxs)("div",{className:"grid gap-6 lg:grid-cols-[300px_1fr]",children:[n.length>0&&(0,t.jsxs)("aside",{className:"lg:sticky lg:top-28 lg:h-fit",children:[(0,t.jsx)(N,{filters:o,onFiltersChange:i,onExportPDF:f,onCopyList:j,onClearAll:()=>{(0,s.clearMedicines)(),r([])}}),"copied"===h&&(0,t.jsx)("div",{className:"mt-2 neu-flat p-2 text-center text-sm animate-fadeInUp",style:{color:"var(--color-success)"},children:"âœ… Skopiowano listÄ™ lekÃ³w!"})]}),(0,t.jsx)("section",{className:0===n.length?"lg:col-span-2":"",children:(0,t.jsx)(y,{medicines:v,filters:o,onDelete:e=>{confirm("Czy na pewno chcesz usunÄ…Ä‡ ten lek z apteczki?")&&((0,s.deleteMedicine)(e),r((0,s.getMedicines)()))},onUpdateExpiry:(e,t)=>{(0,s.updateMedicine)(e,{terminWaznosci:t}),r((0,s.getMedicines)())},onUpdateLabels:(e,t)=>{(0,s.updateMedicine)(e,{labels:t}),r((0,s.getMedicines)())},onUpdateNote:(e,t)=>{(0,s.updateMedicine)(e,{notatka:t}),r((0,s.getMedicines)())},onUpdateLeaflet:(e,t)=>{(0,s.updateMedicine)(e,{leafletUrl:t}),r((0,s.getMedicines)())},totalCount:n.length,sortBy:x,sortDir:u,onSortChange:e=>{x===e?p(e=>"asc"===e?"desc":"asc"):(m(e),p("asc"))}})})]})}):(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)("div",{className:"neu-skeleton h-12 w-48"}),(0,t.jsx)("div",{className:"grid gap-5 sm:grid-cols-2 lg:grid-cols-3",children:[1,2,3].map(e=>(0,t.jsx)("div",{className:"neu-skeleton h-64"},e))})]})}e.s(["default",()=>z],39798)}]);